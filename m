Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 80A0C14D49D
	for <lists+xen-devel@lfdr.de>; Thu, 30 Jan 2020 01:19:31 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iwxVP-0002x5-2b; Thu, 30 Jan 2020 00:16:23 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=e642=3T=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iwxVN-0002x0-HL
 for xen-devel@lists.xenproject.org; Thu, 30 Jan 2020 00:16:21 +0000
X-Inumbo-ID: bbc23b36-42f5-11ea-ad98-bc764e2007e4
Received: from mail-lj1-x243.google.com (unknown [2a00:1450:4864:20::243])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id bbc23b36-42f5-11ea-ad98-bc764e2007e4;
 Thu, 30 Jan 2020 00:16:17 +0000 (UTC)
Received: by mail-lj1-x243.google.com with SMTP id d10so1334845ljl.9
 for <xen-devel@lists.xenproject.org>; Wed, 29 Jan 2020 16:16:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc; bh=FWeRnLwKl1w2sWXIcM/o0nD2NeCsSa3ngvndlf/3t+8=;
 b=mC3zdeiggUulx5dtT9UBvEf+kufZ4PBNtyiRmLJ+7n1nc0Kq5CEETuLpMoKBFOPDc6
 Qwccj7cH8CpSM5PanHzCxTDHdoLPpINKGft/JYBYTWaXErof0wbmurU3DbmxAz37Xm/1
 oDbm6h8kWsDT5TXf8varkYhojOtvynSePf85G2090lxC0Oq8xMnEveWWtFqQpUoFK0WW
 OCqUffa7mQXuaGVNdj+dkGGxa2niX6kh8PUQS107ub3gUTph2lRa7/zYu0pySJ32DQhr
 65Q3lCITLPPemvwjbFqfDq5YTAfhCdENt1RYEb4eS8qe0qJdPz/nFEmy0REtVMxMh96H
 xtIw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=FWeRnLwKl1w2sWXIcM/o0nD2NeCsSa3ngvndlf/3t+8=;
 b=iCbP7KP/wfgGDvxH2VFLcUJ3WoyG6XSWWKnG2GDhKXR4boISyJYunLDxf9ZkKlPd8h
 KOtQ07mDzSTlL+NbSfbfQlrmx0DHZ4RnGAGeMInvdcHChzWTtWZ+GhZuNCJN9P2B3eNp
 J9c0Q+UGQ+L2cMIGwGIaCuJ35bO3XCnMxfZRtqv0Do67KKIWseYQaLxHH8Ju0yOnE4SC
 3m6AUtHgwDeF9GV3qUzvPZooxSCn8R7PEIdBgBUoEWCKGPKsywWfSkF440LQ3DEgzHRS
 WFOA73eBkHKoM8asIgqKRXn+mQdk41ybL+d7dXdzIQRLaw1gdpS/nlW7hb89871bP27P
 MDow==
X-Gm-Message-State: APjAAAViz8ZlWYlPxqbckcZ04Ehkyi9w60tmUMGfBJV53veawYS+LpWU
 mu8IDuvOQsc/m5NzhQymB4i67a+liaFTw3OQvrsgqMtd
X-Google-Smtp-Source: APXvYqw+ZiZ0qJX2XskppZ99bf4NS3Ra9Oh4KuQ334LfzuvFRjEbMNjMrFm+KXGkp1J4SynKlhY6sCY39Q6lqoT7mYE=
X-Received: by 2002:a2e:8490:: with SMTP id b16mr1030907ljh.282.1580343375483; 
 Wed, 29 Jan 2020 16:16:15 -0800 (PST)
MIME-Version: 1.0
References: <d60703d51d76417a5ba41064d66229440c3b4a50.1580342990.git.rosbrookn@ainfosec.com>
In-Reply-To: <d60703d51d76417a5ba41064d66229440c3b4a50.1580342990.git.rosbrookn@ainfosec.com>
From: Nick Rosbrook <rosbrookn@gmail.com>
Date: Wed, 29 Jan 2020 19:16:03 -0500
Message-ID: <CAEBZRScxKLmcfhW4+JD7wyGp+u=KT8qmom49S_5iWXox6QFrow@mail.gmail.com>
To: Xen-devel <xen-devel@lists.xenproject.org>
Subject: Re: [Xen-devel] [PATCH] golang/xenlight: implement constructor
 generation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

R2VvcmdlLAoKTm90ZSB0aGF0IHdpdGhvdXQgeW91ciBwYXRjaCAiZ29sYW5nL3hlbmxpZ2h0OiBE
b24ndCB0cnkgdG8gbWFyc2hhbGwKemVyby1sZW5ndGggYXJyYXlzIGluIGZyb21DIiwgc29tZSBv
ZiB0aGVzZSBjb25zdHJ1Y3RvcnMgd2lsbCBwYW5pYy4KClRoYW5rcywKLU5SCgpPbiBXZWQsIEph
biAyOSwgMjAyMCBhdCA3OjA5IFBNIE5pY2sgUm9zYnJvb2sgPHJvc2Jyb29rbkBnbWFpbC5jb20+
IHdyb3RlOgo+Cj4gR2VuZXJhdGUgY29uc3RydWN0b3JzIGZvciBnZW5lcmF0ZWQgR28gdHlwZXMu
IENhbGwgbGlieGxfPHR5cGU+X2luaXQgc28KPiB0aGUgR28gdHlwZSBjYW4gYmUgcHJvcGVybHkg
aW5pdGlhbGl6ZWQuCj4KPiBJZiBhIHR5cGUgaGFzIGEga2V5ZWQgdW5pb24gZmllbGQsIGFkZCBh
IHBhcmFtZXRlciB0byB0aGUgZnVuY3Rpb24KPiBzaWduYXR1cmUgdG8gc2V0IHRoZSBrZXkgdmFy
aWFibGUsIGFuZCBjYWxsIHRoZSBpbml0IGZ1bmN0aW9uIGZvciB0aGUKPiBrZXllZCB1bmlvbi4K
Pgo+IFNpZ25lZC1vZmYtYnk6IE5pY2sgUm9zYnJvb2sgPHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+
Cj4gLS0tCj4gIHRvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5ICB8ICAgNjUgKysK
PiAgdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBlcnMuZ2VuLmdvIHwgMTAwMiArKysrKysrKysr
KysrKysrKysrKysrKysrLQo+ICAyIGZpbGVzIGNoYW5nZWQsIDEwNDkgaW5zZXJ0aW9ucygrKSwg
MTggZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dl
bmdvdHlwZXMucHkgYi90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weQo+IGluZGV4
IGIwOWNmZmI4MjkuLmFlYzE1MzA5OGQgMTAwNjQ0Cj4gLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxp
Z2h0L2dlbmdvdHlwZXMucHkKPiArKysgYi90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBl
cy5weQo+IEBAIC0yMjUsNiArMjI1LDkgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19nZW5lcmF0ZV9o
ZWxwZXJzKHBhdGggPSBOb25lLCB0eXBlcyA9IE5vbmUsIGNvbW1lbnQgPSBOb25lKToKPiAgICAg
ICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodHksIGlkbC5TdHJ1Y3QpOgo+ICAgICAgICAgICAg
ICAgICAgY29udGludWUKPgo+ICsgICAgICAgICAgICBmLndyaXRlKHhlbmxpZ2h0X2dvbGFuZ19k
ZWZpbmVfY29uc3RydWN0b3IodHkpKQo+ICsgICAgICAgICAgICBmLndyaXRlKCdcbicpCj4gKwo+
ICAgICAgICAgICAgICAoZmRlZiwgZXh0cmFzKSA9IHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfZnJv
bV9DKHR5KQo+Cj4gICAgICAgICAgICAgIGYud3JpdGUoZmRlZikKPiBAQCAtNjE5LDYgKzYyMiw2
OCBAQCBkZWYgeGVubGlnaHRfZ29sYW5nX2FycmF5X3RvX0ModHkgPSBOb25lKToKPgo+ICAgICAg
cmV0dXJuIHMKPgo+ICtkZWYgeGVubGlnaHRfZ29sYW5nX2RlZmluZV9jb25zdHJ1Y3Rvcih0eSA9
IE5vbmUpOgo+ICsgICAgcyA9ICcnCj4gKwo+ICsgICAgY3R5cGVuYW1lICA9IHR5LnR5cGVuYW1l
Cj4gKyAgICBnb3R5cGVuYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKGN0eXBlbmFtZSkK
PiArCj4gKyAgICAjIFNpbmNlIHRoaXMgZnVuYyBpcyBleHBvcnRlZCwgYWRkIGEgY29tbWVudCBh
cyBwZXIgR28gY29udmVudGlvbnMuCj4gKyAgICBzICs9ICcvLyBOZXd7fSByZXR1cm5zIGFuIGlu
c3RhbmNlIG9mIHt9Jy5mb3JtYXQoZ290eXBlbmFtZSxnb3R5cGVuYW1lKQo+ICsgICAgcyArPSAn
IGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuXG4nCj4gKwo+ICsgICAgIyBJZiBhIHN0cnVjdCBo
YXMgYSBrZXllZCB1bmlvbiwgYW4gZXh0cmEgYXJndW1lbnQgaXMKPiArICAgICMgcmVxdWlyZWQg
aW4gdGhlIGZ1bmN0aW9uIHNpZ25hdHVyZSwgYW5kIGFuIGV4dHJhIF9pbml0Cj4gKyAgICAjIGNh
bGwgaXMgbmVlZGVkLgo+ICsgICAgcGFyYW1zICAgPSBbXQo+ICsgICAgaW5pdF9mbnMgPSBbXQo+
ICsKPiArICAgICMgQWRkIGNhbGwgdG8gcGFyZW50IGluaXRfZm4gZmlyc3QuCj4gKyAgICBpbml0
X2Zucy5hcHBlbmQoJ0Mue30oJnhjKScuZm9ybWF0KHR5LmluaXRfZm4pKQo+ICsKPiArICAgIGZv
ciBmIGluIHR5LmZpZWxkczoKPiArICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShmLnR5cGUsIGlk
bC5LZXllZFVuaW9uKToKPiArICAgICAgICAgICAgY29udGludWUKPiArCj4gKyAgICAgICAgcGFy
YW0gPSBmLnR5cGUua2V5dmFyCj4gKwo+ICsgICAgICAgIHBhcmFtX2N0eXBlICA9IHBhcmFtLnR5
cGUudHlwZW5hbWUKPiArICAgICAgICBwYXJhbV9nb3R5cGUgPSB4ZW5saWdodF9nb2xhbmdfZm10
X25hbWUocGFyYW1fY3R5cGUpCj4gKyAgICAgICAgcGFyYW1fZ29uYW1lID0geGVubGlnaHRfZ29s
YW5nX2ZtdF9uYW1lKHBhcmFtLm5hbWUsZXhwb3J0ZWQ9RmFsc2UpCj4gKwo+ICsgICAgICAgICMg
U2VydmVyYWwga2V5ZWQgdW5pb25zIHVzZSAndHlwZScgYXMgdGhlIGtleSB2YXJpYWJsZSBuYW1l
LiBJbgo+ICsgICAgICAgICMgdGhhdCBjYXNlLCBwcmVwZW5kIHRoZSBmaXJzdCBsZXR0ZXIgb2Yg
dGhlIEdvIHR5cGUgbmFtZS4KPiArICAgICAgICBpZiBwYXJhbV9nb25hbWUgPT0gJ3R5cGUnOgo+
ICsgICAgICAgICAgICBwYXJhbV9nb25hbWUgPSAne310eXBlJy5mb3JtYXQocGFyYW1fZ290eXBl
Lmxvd2VyKClbMF0pCj4gKwo+ICsgICAgICAgICMgQWRkIGNhbGwgdG8ga2V5ZWQgdW5pb24ncyBp
bml0X2ZuLgo+ICsgICAgICAgIGluaXRfZm5zLmFwcGVuZCgnQy57fV97fSgmeGMsIEMue30oe30p
KScuZm9ybWF0KHR5LmluaXRfZm4sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW0ubmFtZSwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbV9jdHlwZSwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJh
bV9nb25hbWUpKQo+ICsKPiArICAgICAgICAjIEFkZCB0byBwYXJhbXMgbGlzdC4KPiArICAgICAg
ICBwYXJhbXMuYXBwZW5kKCd7fSB7fScuZm9ybWF0KHBhcmFtX2dvbmFtZSwgcGFyYW1fZ290eXBl
KSkKPiArCj4gKyAgICAjIERlZmluZSBmdW5jdGlvbgo+ICsgICAgcyArPSAnZnVuYyBOZXd7fSh7
fSkgKCp7fSwgZXJyb3IpIHt7XG4nLmZvcm1hdChnb3R5cGVuYW1lLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLCcuam9pbihwYXJhbXMpLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3R5
cGVuYW1lKQo+ICsKPiArICAgICMgRGVjbGFyZSB2YXJpYWJsZXMuCj4gKyAgICBzICs9ICd2YXIg
KFxueCB7fVxueGMgQy57fSlcblxuJy5mb3JtYXQoZ290eXBlbmFtZSwgY3R5cGVuYW1lKQo+ICsK
PiArICAgICMgV3JpdGUgaW5pdF9mbiBjYWxscy4KPiArICAgIHMgKz0gJ1xuJy5qb2luKGluaXRf
Zm5zKQo+ICsgICAgcyArPSAnXG5cbicKPiArCj4gKyAgICAjIENhbGwgZnJvbUMgdG8gaW5pdGlh
bGl6ZSBHbyB0eXBlLgo+ICsgICAgcyArPSAnaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9
IG5pbCB7XG4nCj4gKyAgICBzICs9ICdyZXR1cm4gbmlsLCBlcnIgfVxuXG4nCj4gKyAgICBzICs9
ICdyZXR1cm4gJngsIG5pbH1cbicKPiArCj4gKyAgICByZXR1cm4gcwo+ICsKPiAgZGVmIHhlbmxp
Z2h0X2dvbGFuZ19mbXRfbmFtZShuYW1lLCBleHBvcnRlZCA9IFRydWUpOgo+ICAgICAgIiIiCj4g
ICAgICBUYWtlIGEgZ2l2ZW4gdHlwZSBuYW1lIGFuZCByZXR1cm4gYW4KPiBkaWZmIC0tZ2l0IGEv
dG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBlcnMuZ2VuLmdvIGIvdG9vbHMvZ29sYW5nL3hlbmxp
Z2h0L2hlbHBlcnMuZ2VuLmdvCj4gaW5kZXggNzQ2ZDk5YjViYS4uMjI1YmE2ODY4ZSAxMDA2NDQK
PiAtLS0gYS90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KPiArKysgYi90b29s
cy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KPiBAQCAtMzAsNiArMzAsMjIgQEAgdHlw
ZWRlZiB0eXBlb2YoKChzdHJ1Y3QgbGlieGxfcHNyX2h3X2luZm8gKilOVUxMKS0+dS5tYmEpbGli
eGxfcHNyX2h3X2luZm9fdHlwZV8KPiAgKi8KPiAgaW1wb3J0ICJDIgo+Cj4gKy8vIE5ld0lvcG9y
dFJhbmdlIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgSW9wb3J0UmFuZ2UgaW5pdGlhbGl6ZWQgd2l0
aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdJb3BvcnRSYW5nZSgpICgqSW9wb3J0UmFuZ2UsIGVycm9y
KSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBJb3BvcnRSYW5nZQo+ICsg
ICAgICAgICAgICAgICB4YyBDLmxpYnhsX2lvcG9ydF9yYW5nZQo+ICsgICAgICAgKQo+ICsKPiAr
ICAgICAgIEMubGlieGxfaW9wb3J0X3JhbmdlX2luaXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVy
ciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4g
bmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4g
Kwo+ICBmdW5jICh4ICpJb3BvcnRSYW5nZSkgZnJvbUMoeGMgKkMubGlieGxfaW9wb3J0X3Jhbmdl
KSBlcnJvciB7Cj4gICAgICAgICB4LkZpcnN0ID0gdWludDMyKHhjLmZpcnN0KQo+ICAgICAgICAg
eC5OdW1iZXIgPSB1aW50MzIoeGMubnVtYmVyKQo+IEBAIC01MCw2ICs2NiwyMiBAQCBmdW5jICh4
ICpJb3BvcnRSYW5nZSkgdG9DKHhjICpDLmxpYnhsX2lvcG9ydF9yYW5nZSkgKGVyciBlcnJvcikg
ewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3SW9tZW1SYW5nZSByZXR1cm5z
IGFuIGluc3RhbmNlIG9mIElvbWVtUmFuZ2UgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiAr
ZnVuYyBOZXdJb21lbVJhbmdlKCkgKCpJb21lbVJhbmdlLCBlcnJvcikgewo+ICsgICAgICAgdmFy
ICgKPiArICAgICAgICAgICAgICAgeCAgSW9tZW1SYW5nZQo+ICsgICAgICAgICAgICAgICB4YyBD
LmxpYnhsX2lvbWVtX3JhbmdlCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9pb21l
bV9yYW5nZV9pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBl
cnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9
Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqSW9tZW1S
YW5nZSkgZnJvbUMoeGMgKkMubGlieGxfaW9tZW1fcmFuZ2UpIGVycm9yIHsKPiAgICAgICAgIHgu
U3RhcnQgPSB1aW50NjQoeGMuc3RhcnQpCj4gICAgICAgICB4Lk51bWJlciA9IHVpbnQ2NCh4Yy5u
dW1iZXIpCj4gQEAgLTcyLDYgKzEwNCwyMiBAQCBmdW5jICh4ICpJb21lbVJhbmdlKSB0b0MoeGMg
KkMubGlieGxfaW9tZW1fcmFuZ2UpIChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwK
PiAgfQo+Cj4gKy8vIE5ld1ZnYUludGVyZmFjZUluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBW
Z2FJbnRlcmZhY2VJbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3Vmdh
SW50ZXJmYWNlSW5mbygpICgqVmdhSW50ZXJmYWNlSW5mbywgZXJyb3IpIHsKPiArICAgICAgIHZh
ciAoCj4gKyAgICAgICAgICAgICAgIHggIFZnYUludGVyZmFjZUluZm8KPiArICAgICAgICAgICAg
ICAgeGMgQy5saWJ4bF92Z2FfaW50ZXJmYWNlX2luZm8KPiArICAgICAgICkKPiArCj4gKyAgICAg
ICBDLmxpYnhsX3ZnYV9pbnRlcmZhY2VfaW5mb19pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBl
cnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJu
IG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+
ICsKPiAgZnVuYyAoeCAqVmdhSW50ZXJmYWNlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmdhX2lu
dGVyZmFjZV9pbmZvKSBlcnJvciB7Cj4gICAgICAgICB4LktpbmQgPSBWZ2FJbnRlcmZhY2VUeXBl
KHhjLmtpbmQpCj4KPiBAQCAtOTAsNiArMTM4LDIyIEBAIGZ1bmMgKHggKlZnYUludGVyZmFjZUlu
Zm8pIHRvQyh4YyAqQy5saWJ4bF92Z2FfaW50ZXJmYWNlX2luZm8pIChlcnIgZXJyb3IpIHsKPiAg
ICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld1ZuY0luZm8gcmV0dXJucyBhbiBpbnN0
YW5jZSBvZiBWbmNJbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3Vm5j
SW5mbygpICgqVm5jSW5mbywgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAg
ICAgIHggIFZuY0luZm8KPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF92bmNfaW5mbwo+ICsg
ICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfdm5jX2luZm9faW5pdCgmeGMpCj4gKwo+ICsg
ICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAg
ICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAmeCwg
bmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKlZuY0luZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZuY19p
bmZvKSBlcnJvciB7Cj4gICAgICAgICBpZiBlcnIgOj0geC5FbmFibGUuZnJvbUMoJnhjLmVuYWJs
ZSk7IGVyciAhPSBuaWwgewo+ICAgICAgICAgICAgICAgICByZXR1cm4gZm10LkVycm9yZigiY29u
dmVydGluZyBmaWVsZCBFbmFibGU6ICV2IiwgZXJyKQo+IEBAIC0xMjgsNiArMTkyLDIyIEBAIGZ1
bmMgKHggKlZuY0luZm8pIHRvQyh4YyAqQy5saWJ4bF92bmNfaW5mbykgKGVyciBlcnJvcikgewo+
ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3U3BpY2VJbmZvIHJldHVybnMgYW4g
aW5zdGFuY2Ugb2YgU3BpY2VJbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMg
TmV3U3BpY2VJbmZvKCkgKCpTcGljZUluZm8sIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsg
ICAgICAgICAgICAgICB4ICBTcGljZUluZm8KPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9z
cGljZV9pbmZvCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9zcGljZV9pbmZvX2lu
aXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwg
ewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAg
ICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpTcGljZUluZm8pIGZyb21D
KHhjICpDLmxpYnhsX3NwaWNlX2luZm8pIGVycm9yIHsKPiAgICAgICAgIGlmIGVyciA6PSB4LkVu
YWJsZS5mcm9tQygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7Cj4gICAgICAgICAgICAgICAgIHJl
dHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEVuYWJsZTogJXYiLCBlcnIpCj4gQEAg
LTE5Niw2ICsyNzYsMjIgQEAgZnVuYyAoeCAqU3BpY2VJbmZvKSB0b0MoeGMgKkMubGlieGxfc3Bp
Y2VfaW5mbykgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8g
TmV3U2RsSW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFNkbEluZm8gaW5pdGlhbGl6ZWQgd2l0
aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdTZGxJbmZvKCkgKCpTZGxJbmZvLCBlcnJvcikgewo+ICsg
ICAgICAgdmFyICgKPiArICAgICAgICAgICAgICAgeCAgU2RsSW5mbwo+ICsgICAgICAgICAgICAg
ICB4YyBDLmxpYnhsX3NkbF9pbmZvCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9z
ZGxfaW5mb19pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBl
cnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9
Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqU2RsSW5m
bykgZnJvbUMoeGMgKkMubGlieGxfc2RsX2luZm8pIGVycm9yIHsKPiAgICAgICAgIGlmIGVyciA6
PSB4LkVuYWJsZS5mcm9tQygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7Cj4gICAgICAgICAgICAg
ICAgIHJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEVuYWJsZTogJXYiLCBlcnIp
Cj4gQEAgLTIzMiw2ICszMjgsMjIgQEAgZnVuYyAoeCAqU2RsSW5mbykgdG9DKHhjICpDLmxpYnhs
X3NkbF9pbmZvKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsv
LyBOZXdEb21pbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRG9taW5mbyBpbml0aWFsaXplZCB3
aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld0RvbWluZm8oKSAoKkRvbWluZm8sIGVycm9yKSB7Cj4g
KyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBEb21pbmZvCj4gKyAgICAgICAgICAg
ICAgIHhjIEMubGlieGxfZG9taW5mbwo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxf
ZG9taW5mb19pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBl
cnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9
Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqRG9taW5m
bykgZnJvbUMoeGMgKkMubGlieGxfZG9taW5mbykgZXJyb3Igewo+ICAgICAgICAgaWYgZXJyIDo9
IHguVXVpZC5mcm9tQygmeGMudXVpZCk7IGVyciAhPSBuaWwgewo+ICAgICAgICAgICAgICAgICBy
ZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBVdWlkOiAldiIsIGVycikKPiBAQCAt
Mjk2LDYgKzQwOCwyMiBAQCBmdW5jICh4ICpEb21pbmZvKSB0b0MoeGMgKkMubGlieGxfZG9taW5m
bykgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3Q3B1
cG9vbGluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBDcHVwb29saW5mbyBpbml0aWFsaXplZCB3
aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld0NwdXBvb2xpbmZvKCkgKCpDcHVwb29saW5mbywgZXJy
b3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIENwdXBvb2xpbmZvCj4g
KyAgICAgICAgICAgICAgIHhjIEMubGlieGxfY3B1cG9vbGluZm8KPiArICAgICAgICkKPiArCj4g
KyAgICAgICBDLmxpYnhsX2NwdXBvb2xpbmZvX2luaXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVy
ciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4g
bmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4g
Kwo+ICBmdW5jICh4ICpDcHVwb29saW5mbykgZnJvbUMoeGMgKkMubGlieGxfY3B1cG9vbGluZm8p
IGVycm9yIHsKPiAgICAgICAgIHguUG9vbGlkID0gdWludDMyKHhjLnBvb2xpZCkKPiAgICAgICAg
IHguUG9vbE5hbWUgPSBDLkdvU3RyaW5nKHhjLnBvb2xfbmFtZSkKPiBAQCAtMzI4LDYgKzQ1Niwy
MyBAQCBmdW5jICh4ICpDcHVwb29saW5mbykgdG9DKHhjICpDLmxpYnhsX2NwdXBvb2xpbmZvKSAo
ZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdDaGFubmVs
aW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIENoYW5uZWxpbmZvIGluaXRpYWxpemVkIHdpdGgg
ZGVmYXVsdHMuCj4gK2Z1bmMgTmV3Q2hhbm5lbGluZm8oY29ubmVjdGlvbiBDaGFubmVsQ29ubmVj
dGlvbikgKCpDaGFubmVsaW5mbywgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAg
ICAgICAgIHggIENoYW5uZWxpbmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfY2hhbm5l
bGluZm8KPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX2NoYW5uZWxpbmZvX2luaXQo
JnhjKQo+ICsgICAgICAgQy5saWJ4bF9jaGFubmVsaW5mb19pbml0X2Nvbm5lY3Rpb24oJnhjLCBD
LmxpYnhsX2NoYW5uZWxfY29ubmVjdGlvbihjb25uZWN0aW9uKSkKPiArCj4gKyAgICAgICBpZiBl
cnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJu
IG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+
ICsKPiAgZnVuYyAoeCAqQ2hhbm5lbGluZm8pIGZyb21DKHhjICpDLmxpYnhsX2NoYW5uZWxpbmZv
KSBlcnJvciB7Cj4gICAgICAgICB4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCj4g
ICAgICAgICB4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQo+IEBAIC00MDEsNiAr
NTQ2LDIyIEBAIGZ1bmMgKHggKkNoYW5uZWxpbmZvKSB0b0MoeGMgKkMubGlieGxfY2hhbm5lbGlu
Zm8pIChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld1Zt
aW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZtaW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1
bHRzLgo+ICtmdW5jIE5ld1ZtaW5mbygpICgqVm1pbmZvLCBlcnJvcikgewo+ICsgICAgICAgdmFy
ICgKPiArICAgICAgICAgICAgICAgeCAgVm1pbmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGli
eGxfdm1pbmZvCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF92bWluZm9faW5pdCgm
eGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4g
KyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAgICAgfQo+ICsKPiArICAgICAg
IHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKlZtaW5mbykgZnJvbUMoeGMgKkMu
bGlieGxfdm1pbmZvKSBlcnJvciB7Cj4gICAgICAgICBpZiBlcnIgOj0geC5VdWlkLmZyb21DKCZ4
Yy51dWlkKTsgZXJyICE9IG5pbCB7Cj4gICAgICAgICAgICAgICAgIHJldHVybiBmbXQuRXJyb3Jm
KCJjb252ZXJ0aW5nIGZpZWxkIFV1aWQ6ICV2IiwgZXJyKQo+IEBAIC00MjUsNiArNTg2LDIyIEBA
IGZ1bmMgKHggKlZtaW5mbykgdG9DKHhjICpDLmxpYnhsX3ZtaW5mbykgKGVyciBlcnJvcikgewo+
ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3VmVyc2lvbkluZm8gcmV0dXJucyBh
biBpbnN0YW5jZSBvZiBWZXJzaW9uSW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtm
dW5jIE5ld1ZlcnNpb25JbmZvKCkgKCpWZXJzaW9uSW5mbywgZXJyb3IpIHsKPiArICAgICAgIHZh
ciAoCj4gKyAgICAgICAgICAgICAgIHggIFZlcnNpb25JbmZvCj4gKyAgICAgICAgICAgICAgIHhj
IEMubGlieGxfdmVyc2lvbl9pbmZvCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF92
ZXJzaW9uX2luZm9faW5pdCgmeGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhj
KTsgZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAg
ICAgfQo+ICsKPiArICAgICAgIHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKlZl
cnNpb25JbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92ZXJzaW9uX2luZm8pIGVycm9yIHsKPiAgICAg
ICAgIHguWGVuVmVyc2lvbk1ham9yID0gaW50KHhjLnhlbl92ZXJzaW9uX21ham9yKQo+ICAgICAg
ICAgeC5YZW5WZXJzaW9uTWlub3IgPSBpbnQoeGMueGVuX3ZlcnNpb25fbWlub3IpCj4gQEAgLTQ4
NSw2ICs2NjIsMjIgQEAgZnVuYyAoeCAqVmVyc2lvbkluZm8pIHRvQyh4YyAqQy5saWJ4bF92ZXJz
aW9uX2luZm8pIChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8v
IE5ld0RvbWFpbkNyZWF0ZUluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEb21haW5DcmVhdGVJ
bmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3RG9tYWluQ3JlYXRlSW5m
bygpICgqRG9tYWluQ3JlYXRlSW5mbywgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAg
ICAgICAgICAgIHggIERvbWFpbkNyZWF0ZUluZm8KPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4
bF9kb21haW5fY3JlYXRlX2luZm8KPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX2Rv
bWFpbl9jcmVhdGVfaW5mb19pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9t
QygmeGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4g
KyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAo
eCAqRG9tYWluQ3JlYXRlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZv
KSBlcnJvciB7Cj4gICAgICAgICB4LlR5cGUgPSBEb21haW5UeXBlKHhjLl90eXBlKQo+ICAgICAg
ICAgaWYgZXJyIDo9IHguSGFwLmZyb21DKCZ4Yy5oYXApOyBlcnIgIT0gbmlsIHsKPiBAQCAtNTYz
LDYgKzc1NiwyMiBAQCBmdW5jICh4ICpEb21haW5DcmVhdGVJbmZvKSB0b0MoeGMgKkMubGlieGxf
ZG9tYWluX2NyZWF0ZV9pbmZvKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4g
IH0KPgo+ICsvLyBOZXdEb21haW5SZXN0b3JlUGFyYW1zIHJldHVybnMgYW4gaW5zdGFuY2Ugb2Yg
RG9tYWluUmVzdG9yZVBhcmFtcyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5l
d0RvbWFpblJlc3RvcmVQYXJhbXMoKSAoKkRvbWFpblJlc3RvcmVQYXJhbXMsIGVycm9yKSB7Cj4g
KyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBEb21haW5SZXN0b3JlUGFyYW1zCj4g
KyAgICAgICAgICAgICAgIHhjIEMubGlieGxfZG9tYWluX3Jlc3RvcmVfcGFyYW1zCj4gKyAgICAg
ICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9kb21haW5fcmVzdG9yZV9wYXJhbXNfaW5pdCgmeGMp
Cj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4gKyAg
ICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJl
dHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKkRvbWFpblJlc3RvcmVQYXJhbXMpIGZy
b21DKHhjICpDLmxpYnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFtcykgZXJyb3Igewo+ICAgICAgICAg
eC5DaGVja3BvaW50ZWRTdHJlYW0gPSBpbnQoeGMuY2hlY2twb2ludGVkX3N0cmVhbSkKPiAgICAg
ICAgIHguU3RyZWFtVmVyc2lvbiA9IHVpbnQzMih4Yy5zdHJlYW1fdmVyc2lvbikKPiBAQCAtNTkz
LDYgKzgwMiwyMiBAQCBmdW5jICh4ICpEb21haW5SZXN0b3JlUGFyYW1zKSB0b0MoeGMgKkMubGli
eGxfZG9tYWluX3Jlc3RvcmVfcGFyYW1zKSAoZXJyIGVycm9yKQo+ICAgICAgICAgcmV0dXJuIG5p
bAo+ICB9Cj4KPiArLy8gTmV3U2NoZWRQYXJhbXMgcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBTY2hl
ZFBhcmFtcyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld1NjaGVkUGFyYW1z
KCkgKCpTY2hlZFBhcmFtcywgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAg
ICAgIHggIFNjaGVkUGFyYW1zCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfc2NoZWRfcGFy
YW1zCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9zY2hlZF9wYXJhbXNfaW5pdCgm
eGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4g
KyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAgICAgfQo+ICsKPiArICAgICAg
IHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKlNjaGVkUGFyYW1zKSBmcm9tQyh4
YyAqQy5saWJ4bF9zY2hlZF9wYXJhbXMpIGVycm9yIHsKPiAgICAgICAgIHguVmNwdWlkID0gaW50
KHhjLnZjcHVpZCkKPiAgICAgICAgIHguV2VpZ2h0ID0gaW50KHhjLndlaWdodCkKPiBAQCAtNjIx
LDYgKzg0NiwyMiBAQCBmdW5jICh4ICpTY2hlZFBhcmFtcykgdG9DKHhjICpDLmxpYnhsX3NjaGVk
X3BhcmFtcykgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8g
TmV3VmNwdVNjaGVkUGFyYW1zIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVmNwdVNjaGVkUGFyYW1z
IGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3VmNwdVNjaGVkUGFyYW1zKCkg
KCpWY3B1U2NoZWRQYXJhbXMsIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAg
ICAgICB4ICBWY3B1U2NoZWRQYXJhbXMKPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF92Y3B1
X3NjaGVkX3BhcmFtcwo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfdmNwdV9zY2hl
ZF9wYXJhbXNfaW5pdCgmeGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsg
ZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAgICAg
fQo+ICsKPiArICAgICAgIHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKlZjcHVT
Y2hlZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfdmNwdV9zY2hlZF9wYXJhbXMpIGVycm9yIHsK
PiAgICAgICAgIHguU2NoZWQgPSBTY2hlZHVsZXIoeGMuc2NoZWQpCj4gICAgICAgICBudW1WY3B1
cyA6PSBpbnQoeGMubnVtX3ZjcHVzKQo+IEBAIC02NTcsNiArODk4LDIyIEBAIGZ1bmMgKHggKlZj
cHVTY2hlZFBhcmFtcykgdG9DKHhjICpDLmxpYnhsX3ZjcHVfc2NoZWRfcGFyYW1zKSAoZXJyIGVy
cm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdEb21haW5TY2hlZFBh
cmFtcyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERvbWFpblNjaGVkUGFyYW1zIGluaXRpYWxpemVk
IHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3RG9tYWluU2NoZWRQYXJhbXMoKSAoKkRvbWFpblNj
aGVkUGFyYW1zLCBlcnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAgICAgICAgICAgICAgeCAg
RG9tYWluU2NoZWRQYXJhbXMKPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9kb21haW5fc2No
ZWRfcGFyYW1zCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9kb21haW5fc2NoZWRf
cGFyYW1zX2luaXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVy
ciAhPSBuaWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0K
PiArCj4gKyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpEb21haW5T
Y2hlZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX3NjaGVkX3BhcmFtcykgZXJyb3Ig
ewo+ICAgICAgICAgeC5TY2hlZCA9IFNjaGVkdWxlcih4Yy5zY2hlZCkKPiAgICAgICAgIHguV2Vp
Z2h0ID0gaW50KHhjLndlaWdodCkKPiBAQCAtNjg5LDYgKzk0NiwyMiBAQCBmdW5jICh4ICpEb21h
aW5TY2hlZFBhcmFtcykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9zY2hlZF9wYXJhbXMpIChlcnIg
ZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld1Zub2RlSW5mbyBy
ZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZub2RlSW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRz
Lgo+ICtmdW5jIE5ld1Zub2RlSW5mbygpICgqVm5vZGVJbmZvLCBlcnJvcikgewo+ICsgICAgICAg
dmFyICgKPiArICAgICAgICAgICAgICAgeCAgVm5vZGVJbmZvCj4gKyAgICAgICAgICAgICAgIHhj
IEMubGlieGxfdm5vZGVfaW5mbwo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfdm5v
ZGVfaW5mb19pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBl
cnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9
Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqVm5vZGVJ
bmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bm9kZV9pbmZvKSBlcnJvciB7Cj4gICAgICAgICB4Lk1l
bWtiID0gdWludDY0KHhjLm1lbWtiKQo+ICAgICAgICAgbnVtRGlzdGFuY2VzIDo9IGludCh4Yy5u
dW1fZGlzdGFuY2VzKQo+IEBAIC03MjksNiArMTAwMiwyMiBAQCBmdW5jICh4ICpWbm9kZUluZm8p
IHRvQyh4YyAqQy5saWJ4bF92bm9kZV9pbmZvKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1
cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdSZG1SZXNlcnZlIHJldHVybnMgYW4gaW5zdGFuY2Ugb2Yg
UmRtUmVzZXJ2ZSBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld1JkbVJlc2Vy
dmUoKSAoKlJkbVJlc2VydmUsIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAg
ICAgICB4ICBSZG1SZXNlcnZlCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfcmRtX3Jlc2Vy
dmUKPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX3JkbV9yZXNlcnZlX2luaXQoJnhj
KQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsg
ICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBy
ZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpSZG1SZXNlcnZlKSBmcm9tQyh4YyAq
Qy5saWJ4bF9yZG1fcmVzZXJ2ZSkgZXJyb3Igewo+ICAgICAgICAgeC5TdHJhdGVneSA9IFJkbVJl
c2VydmVTdHJhdGVneSh4Yy5zdHJhdGVneSkKPiAgICAgICAgIHguUG9saWN5ID0gUmRtUmVzZXJ2
ZVBvbGljeSh4Yy5wb2xpY3kpCj4gQEAgLTc0OSw2ICsxMDM4LDIzIEBAIGZ1bmMgKHggKlJkbVJl
c2VydmUpIHRvQyh4YyAqQy5saWJ4bF9yZG1fcmVzZXJ2ZSkgKGVyciBlcnJvcikgewo+ICAgICAg
ICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3RG9tYWluQnVpbGRJbmZvIHJldHVybnMgYW4g
aW5zdGFuY2Ugb2YgRG9tYWluQnVpbGRJbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4g
K2Z1bmMgTmV3RG9tYWluQnVpbGRJbmZvKGR0eXBlIERvbWFpblR5cGUpICgqRG9tYWluQnVpbGRJ
bmZvLCBlcnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAgICAgICAgICAgICAgeCAgRG9tYWlu
QnVpbGRJbmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfZG9tYWluX2J1aWxkX2luZm8K
PiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2luaXQo
JnhjKQo+ICsgICAgICAgQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19pbml0X3R5cGUoJnhjLCBD
LmxpYnhsX2RvbWFpbl90eXBlKGR0eXBlKSkKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9t
QygmeGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4g
KyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAo
eCAqRG9tYWluQnVpbGRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykg
ZXJyb3Igewo+ICAgICAgICAgeC5NYXhWY3B1cyA9IGludCh4Yy5tYXhfdmNwdXMpCj4gICAgICAg
ICBpZiBlcnIgOj0geC5BdmFpbFZjcHVzLmZyb21DKCZ4Yy5hdmFpbF92Y3B1cyk7IGVyciAhPSBu
aWwgewo+IEBAIC04NzgsMTggKzExODQsMTggQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSBm
cm9tQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3Igewo+ICAgICAgICAgeC5U
ZWUgPSBUZWVUeXBlKHhjLnRlZSkKPiAgICAgICAgIHguVHlwZSA9IERvbWFpblR5cGUoeGMuX3R5
cGUpCj4gICAgICAgICBzd2l0Y2ggeC5UeXBlIHsKPiAtICAgICAgIGNhc2UgRG9tYWluVHlwZUh2
bToKPiAtICAgICAgICAgICAgICAgdmFyIHR5cGVIdm0gRG9tYWluQnVpbGRJbmZvVHlwZVVuaW9u
SHZtCj4gLSAgICAgICAgICAgICAgIGlmIGVyciA6PSB0eXBlSHZtLmZyb21DKHhjKTsgZXJyICE9
IG5pbCB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZl
cnRpbmcgZmllbGQgdHlwZUh2bTogJXYiLCBlcnIpCj4gLSAgICAgICAgICAgICAgIH0KPiAtICAg
ICAgICAgICAgICAgeC5UeXBlVW5pb24gPSB0eXBlSHZtCj4gICAgICAgICBjYXNlIERvbWFpblR5
cGVQdjoKPiAgICAgICAgICAgICAgICAgdmFyIHR5cGVQdiBEb21haW5CdWlsZEluZm9UeXBlVW5p
b25Qdgo+ICAgICAgICAgICAgICAgICBpZiBlcnIgOj0gdHlwZVB2LmZyb21DKHhjKTsgZXJyICE9
IG5pbCB7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZl
cnRpbmcgZmllbGQgdHlwZVB2OiAldiIsIGVycikKPiAgICAgICAgICAgICAgICAgfQo+ICAgICAg
ICAgICAgICAgICB4LlR5cGVVbmlvbiA9IHR5cGVQdgo+ICsgICAgICAgY2FzZSBEb21haW5UeXBl
SHZtOgo+ICsgICAgICAgICAgICAgICB2YXIgdHlwZUh2bSBEb21haW5CdWlsZEluZm9UeXBlVW5p
b25Idm0KPiArICAgICAgICAgICAgICAgaWYgZXJyIDo9IHR5cGVIdm0uZnJvbUMoeGMpOyBlcnIg
IT0gbmlsIHsKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm10LkVycm9yZigiY29u
dmVydGluZyBmaWVsZCB0eXBlSHZtOiAldiIsIGVycikKPiArICAgICAgICAgICAgICAgfQo+ICsg
ICAgICAgICAgICAgICB4LlR5cGVVbmlvbiA9IHR5cGVIdm0KPiAgICAgICAgIGNhc2UgRG9tYWlu
VHlwZVB2aDoKPiAgICAgICAgICAgICAgICAgdmFyIHR5cGVQdmggRG9tYWluQnVpbGRJbmZvVHlw
ZVVuaW9uUHZoCj4gICAgICAgICAgICAgICAgIGlmIGVyciA6PSB0eXBlUHZoLmZyb21DKHhjKTsg
ZXJyICE9IG5pbCB7Cj4gQEAgLTE0MDYsNiArMTcxMiwyMiBAQCBmdW5jICh4ICpEb21haW5CdWls
ZEluZm8pIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgKGVyciBlcnJvcikgewo+
ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3RGV2aWNlVmZiIHJldHVybnMgYW4g
aW5zdGFuY2Ugb2YgRGV2aWNlVmZiIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMg
TmV3RGV2aWNlVmZiKCkgKCpEZXZpY2VWZmIsIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsg
ICAgICAgICAgICAgICB4ICBEZXZpY2VWZmIKPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9k
ZXZpY2VfdmZiCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9kZXZpY2VfdmZiX2lu
aXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwg
ewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAg
ICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpEZXZpY2VWZmIpIGZyb21D
KHhjICpDLmxpYnhsX2RldmljZV92ZmIpIGVycm9yIHsKPiAgICAgICAgIHguQmFja2VuZERvbWlk
ID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKPiAgICAgICAgIHguQmFja2VuZERvbW5hbWUgPSBD
LkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKPiBAQCAtMTQ0Niw2ICsxNzY4LDIyIEBAIGZ1
bmMgKHggKkRldmljZVZmYikgdG9DKHhjICpDLmxpYnhsX2RldmljZV92ZmIpIChlcnIgZXJyb3Ip
IHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld0RldmljZVZrYiByZXR1cm5z
IGFuIGluc3RhbmNlIG9mIERldmljZVZrYiBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtm
dW5jIE5ld0RldmljZVZrYigpICgqRGV2aWNlVmtiLCBlcnJvcikgewo+ICsgICAgICAgdmFyICgK
PiArICAgICAgICAgICAgICAgeCAgRGV2aWNlVmtiCj4gKyAgICAgICAgICAgICAgIHhjIEMubGli
eGxfZGV2aWNlX3ZrYgo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfZGV2aWNlX3Zr
Yl9pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0g
bmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+
ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqRGV2aWNlVmtiKSBm
cm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmtiKSBlcnJvciB7Cj4gICAgICAgICB4LkJhY2tlbmRE
b21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCj4gICAgICAgICB4LkJhY2tlbmREb21uYW1l
ID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCj4gQEAgLTE0OTYsNiArMTgzNCwyMiBA
QCBmdW5jICh4ICpEZXZpY2VWa2IpIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmtiKSAoZXJyIGVy
cm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdEZXZpY2VEaXNrIHJl
dHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNlRGlzayBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRz
Lgo+ICtmdW5jIE5ld0RldmljZURpc2soKSAoKkRldmljZURpc2ssIGVycm9yKSB7Cj4gKyAgICAg
ICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBEZXZpY2VEaXNrCj4gKyAgICAgICAgICAgICAg
IHhjIEMubGlieGxfZGV2aWNlX2Rpc2sKPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhs
X2RldmljZV9kaXNrX2luaXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4
Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAg
ICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpE
ZXZpY2VEaXNrKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfZGlzaykgZXJyb3Igewo+ICAgICAg
ICAgeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQo+ICAgICAgICAgeC5C
YWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQo+IEBAIC0xNTc4
LDYgKzE5MzIsMjIgQEAgZnVuYyAoeCAqRGV2aWNlRGlzaykgdG9DKHhjICpDLmxpYnhsX2Rldmlj
ZV9kaXNrKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBO
ZXdEZXZpY2VOaWMgcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEZXZpY2VOaWMgaW5pdGlhbGl6ZWQg
d2l0aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdEZXZpY2VOaWMoKSAoKkRldmljZU5pYywgZXJyb3Ip
IHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIERldmljZU5pYwo+ICsgICAg
ICAgICAgICAgICB4YyBDLmxpYnhsX2RldmljZV9uaWMKPiArICAgICAgICkKPiArCj4gKyAgICAg
ICBDLmxpYnhsX2RldmljZV9uaWNfaW5pdCgmeGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHgu
ZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVy
cgo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1
bmMgKHggKkRldmljZU5pYykgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX25pYykgZXJyb3Igewo+
ICAgICAgICAgeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQo+ICAgICAg
ICAgeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQo+IEBA
IC0xODM2LDYgKzIyMDYsMjIgQEAgZnVuYyAoeCAqRGV2aWNlTmljKSB0b0MoeGMgKkMubGlieGxf
ZGV2aWNlX25pYykgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiAr
Ly8gTmV3RGV2aWNlUGNpIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNlUGNpIGluaXRpYWxp
emVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3RGV2aWNlUGNpKCkgKCpEZXZpY2VQY2ksIGVy
cm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBEZXZpY2VQY2kKPiAr
ICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9kZXZpY2VfcGNpCj4gKyAgICAgICApCj4gKwo+ICsg
ICAgICAgQy5saWJ4bF9kZXZpY2VfcGNpX2luaXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6
PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmls
LCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+
ICBmdW5jICh4ICpEZXZpY2VQY2kpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9wY2kpIGVycm9y
IHsKPiAgICAgICAgIHguRnVuYyA9IGJ5dGUoeGMuX2Z1bmMpCj4gICAgICAgICB4LkRldiA9IGJ5
dGUoeGMuZGV2KQo+IEBAIC0xODc0LDYgKzIyNjAsMjIgQEAgZnVuYyAoeCAqRGV2aWNlUGNpKSB0
b0MoeGMgKkMubGlieGxfZGV2aWNlX3BjaSkgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJu
IG5pbAo+ICB9Cj4KPiArLy8gTmV3RGV2aWNlUmRtIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2
aWNlUmRtIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3RGV2aWNlUmRtKCkg
KCpEZXZpY2VSZG0sIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4
ICBEZXZpY2VSZG0KPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9kZXZpY2VfcmRtCj4gKyAg
ICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9kZXZpY2VfcmRtX2luaXQoJnhjKQo+ICsKPiAr
ICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAg
ICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngs
IG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpEZXZpY2VSZG0pIGZyb21DKHhjICpDLmxpYnhsX2Rl
dmljZV9yZG0pIGVycm9yIHsKPiAgICAgICAgIHguU3RhcnQgPSB1aW50NjQoeGMuc3RhcnQpCj4g
ICAgICAgICB4LlNpemUgPSB1aW50NjQoeGMuc2l6ZSkKPiBAQCAtMTg5Niw2ICsyMjk4LDIyIEBA
IGZ1bmMgKHggKkRldmljZVJkbSkgdG9DKHhjICpDLmxpYnhsX2RldmljZV9yZG0pIChlcnIgZXJy
b3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld0RldmljZVVzYmN0cmwg
cmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEZXZpY2VVc2JjdHJsIGluaXRpYWxpemVkIHdpdGggZGVm
YXVsdHMuCj4gK2Z1bmMgTmV3RGV2aWNlVXNiY3RybCgpICgqRGV2aWNlVXNiY3RybCwgZXJyb3Ip
IHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIERldmljZVVzYmN0cmwKPiAr
ICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9kZXZpY2VfdXNiY3RybAo+ICsgICAgICAgKQo+ICsK
PiArICAgICAgIEMubGlieGxfZGV2aWNlX3VzYmN0cmxfaW5pdCgmeGMpCj4gKwo+ICsgICAgICAg
aWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgIHJl
dHVybiBuaWwsIGVycgo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAmeCwgbmlsCj4g
K30KPiArCj4gIGZ1bmMgKHggKkRldmljZVVzYmN0cmwpIGZyb21DKHhjICpDLmxpYnhsX2Rldmlj
ZV91c2JjdHJsKSBlcnJvciB7Cj4gICAgICAgICB4LlR5cGUgPSBVc2JjdHJsVHlwZSh4Yy5fdHlw
ZSkKPiAgICAgICAgIHguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKPiBAQCAtMTkyNiw2ICsyMzQ0
LDIzIEBAIGZ1bmMgKHggKkRldmljZVVzYmN0cmwpIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNi
Y3RybCkgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3
RGV2aWNlVXNiZGV2IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNlVXNiZGV2IGluaXRpYWxp
emVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3RGV2aWNlVXNiZGV2KHV0eXBlIFVzYmRldlR5
cGUpICgqRGV2aWNlVXNiZGV2LCBlcnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAgICAgICAg
ICAgICAgeCAgRGV2aWNlVXNiZGV2Cj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfZGV2aWNl
X3VzYmRldgo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfZGV2aWNlX3VzYmRldl9p
bml0KCZ4YykKPiArICAgICAgIEMubGlieGxfZGV2aWNlX3VzYmRldl9pbml0X3R5cGUoJnhjLCBD
LmxpYnhsX3VzYmRldl90eXBlKHV0eXBlKSkKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9t
QygmeGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4g
KyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAo
eCAqRGV2aWNlVXNiZGV2KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNiZGV2KSBlcnJvciB7
Cj4gICAgICAgICB4LkN0cmwgPSBEZXZpZCh4Yy5jdHJsKQo+ICAgICAgICAgeC5Qb3J0ID0gaW50
KHhjLnBvcnQpCj4gQEAgLTE5ODMsNiArMjQxOCwyMiBAQCBmdW5jICh4ICpEZXZpY2VVc2JkZXYp
IHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNiZGV2KSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICBy
ZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdEZXZpY2VEdGRldiByZXR1cm5zIGFuIGluc3RhbmNl
IG9mIERldmljZUR0ZGV2IGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3RGV2
aWNlRHRkZXYoKSAoKkRldmljZUR0ZGV2LCBlcnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAg
ICAgICAgICAgICAgeCAgRGV2aWNlRHRkZXYKPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9k
ZXZpY2VfZHRkZXYKPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX2RldmljZV9kdGRl
dl9pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0g
bmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+
ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqRGV2aWNlRHRkZXYp
IGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9kdGRldikgZXJyb3Igewo+ICAgICAgICAgeC5QYXRo
ID0gQy5Hb1N0cmluZyh4Yy5wYXRoKQo+Cj4gQEAgLTIwMDMsNiArMjQ1NCwyMiBAQCBmdW5jICh4
ICpEZXZpY2VEdGRldikgdG9DKHhjICpDLmxpYnhsX2RldmljZV9kdGRldikgKGVyciBlcnJvcikg
ewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3RGV2aWNlVnRwbSByZXR1cm5z
IGFuIGluc3RhbmNlIG9mIERldmljZVZ0cG0gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiAr
ZnVuYyBOZXdEZXZpY2VWdHBtKCkgKCpEZXZpY2VWdHBtLCBlcnJvcikgewo+ICsgICAgICAgdmFy
ICgKPiArICAgICAgICAgICAgICAgeCAgRGV2aWNlVnRwbQo+ICsgICAgICAgICAgICAgICB4YyBD
LmxpYnhsX2RldmljZV92dHBtCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9kZXZp
Y2VfdnRwbV9pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBl
cnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9
Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqRGV2aWNl
VnRwbSkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3Z0cG0pIGVycm9yIHsKPiAgICAgICAgIHgu
QmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKPiAgICAgICAgIHguQmFja2Vu
ZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKPiBAQCAtMjAzMyw2ICsy
NTAwLDIyIEBAIGZ1bmMgKHggKkRldmljZVZ0cG0pIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfdnRw
bSkgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3RGV2
aWNlUDkgcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEZXZpY2VQOSBpbml0aWFsaXplZCB3aXRoIGRl
ZmF1bHRzLgo+ICtmdW5jIE5ld0RldmljZVA5KCkgKCpEZXZpY2VQOSwgZXJyb3IpIHsKPiArICAg
ICAgIHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIERldmljZVA5Cj4gKyAgICAgICAgICAgICAg
IHhjIEMubGlieGxfZGV2aWNlX3A5Cj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9k
ZXZpY2VfcDlfaW5pdCgmeGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsg
ZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAgICAg
fQo+ICsKPiArICAgICAgIHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKkRldmlj
ZVA5KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcDkpIGVycm9yIHsKPiAgICAgICAgIHguQmFj
a2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKPiAgICAgICAgIHguQmFja2VuZERv
bW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKPiBAQCAtMjA2OSw2ICsyNTUy
LDIyIEBAIGZ1bmMgKHggKkRldmljZVA5KSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3A5KSAoZXJy
IGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdEZXZpY2VQdmNh
bGxzaWYgcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEZXZpY2VQdmNhbGxzaWYgaW5pdGlhbGl6ZWQg
d2l0aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdEZXZpY2VQdmNhbGxzaWYoKSAoKkRldmljZVB2Y2Fs
bHNpZiwgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIERldmlj
ZVB2Y2FsbHNpZgo+ICsgICAgICAgICAgICAgICB4YyBDLmxpYnhsX2RldmljZV9wdmNhbGxzaWYK
PiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX2RldmljZV9wdmNhbGxzaWZfaW5pdCgm
eGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4g
KyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAgICAgfQo+ICsKPiArICAgICAg
IHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKkRldmljZVB2Y2FsbHNpZikgZnJv
bUMoeGMgKkMubGlieGxfZGV2aWNlX3B2Y2FsbHNpZikgZXJyb3Igewo+ICAgICAgICAgeC5CYWNr
ZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQo+ICAgICAgICAgeC5CYWNrZW5kRG9t
bmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQo+IEBAIC0yMDkzLDYgKzI1OTIs
MjMgQEAgZnVuYyAoeCAqRGV2aWNlUHZjYWxsc2lmKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3B2
Y2FsbHNpZikgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8g
TmV3RGV2aWNlQ2hhbm5lbCByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERldmljZUNoYW5uZWwgaW5p
dGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdEZXZpY2VDaGFubmVsKGNvbm5lY3Rp
b24gQ2hhbm5lbENvbm5lY3Rpb24pICgqRGV2aWNlQ2hhbm5lbCwgZXJyb3IpIHsKPiArICAgICAg
IHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIERldmljZUNoYW5uZWwKPiArICAgICAgICAgICAg
ICAgeGMgQy5saWJ4bF9kZXZpY2VfY2hhbm5lbAo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMu
bGlieGxfZGV2aWNlX2NoYW5uZWxfaW5pdCgmeGMpCj4gKyAgICAgICBDLmxpYnhsX2RldmljZV9j
aGFubmVsX2luaXRfY29ubmVjdGlvbigmeGMsIEMubGlieGxfY2hhbm5lbF9jb25uZWN0aW9uKGNv
bm5lY3Rpb24pKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBu
aWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4g
KyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpEZXZpY2VDaGFubmVs
KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfY2hhbm5lbCkgZXJyb3Igewo+ICAgICAgICAgeC5C
YWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQo+ICAgICAgICAgeC5CYWNrZW5k
RG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQo+IEBAIC0yMTU4LDYgKzI2
NzQsMjIgQEAgZnVuYyAoeCAqRGV2aWNlQ2hhbm5lbCkgdG9DKHhjICpDLmxpYnhsX2RldmljZV9j
aGFubmVsKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBO
ZXdDb25uZWN0b3JQYXJhbSByZXR1cm5zIGFuIGluc3RhbmNlIG9mIENvbm5lY3RvclBhcmFtIGlu
aXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3Q29ubmVjdG9yUGFyYW0oKSAoKkNv
bm5lY3RvclBhcmFtLCBlcnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAgICAgICAgICAgICAg
eCAgQ29ubmVjdG9yUGFyYW0KPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9jb25uZWN0b3Jf
cGFyYW0KPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX2Nvbm5lY3Rvcl9wYXJhbV9p
bml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmls
IHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsg
ICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqQ29ubmVjdG9yUGFyYW0p
IGZyb21DKHhjICpDLmxpYnhsX2Nvbm5lY3Rvcl9wYXJhbSkgZXJyb3Igewo+ICAgICAgICAgeC5V
bmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQo+ICAgICAgICAgeC5XaWR0aCA9IHVp
bnQzMih4Yy53aWR0aCkKPiBAQCAtMjE4Miw2ICsyNzE0LDIyIEBAIGZ1bmMgKHggKkNvbm5lY3Rv
clBhcmFtKSB0b0MoeGMgKkMubGlieGxfY29ubmVjdG9yX3BhcmFtKSAoZXJyIGVycm9yKSB7Cj4g
ICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdEZXZpY2VWZGlzcGwgcmV0dXJucyBh
biBpbnN0YW5jZSBvZiBEZXZpY2VWZGlzcGwgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiAr
ZnVuYyBOZXdEZXZpY2VWZGlzcGwoKSAoKkRldmljZVZkaXNwbCwgZXJyb3IpIHsKPiArICAgICAg
IHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIERldmljZVZkaXNwbAo+ICsgICAgICAgICAgICAg
ICB4YyBDLmxpYnhsX2RldmljZV92ZGlzcGwKPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxp
YnhsX2RldmljZV92ZGlzcGxfaW5pdCgmeGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJv
bUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+
ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMg
KHggKkRldmljZVZkaXNwbCkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZkaXNwbCkgZXJyb3Ig
ewo+ICAgICAgICAgeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQo+ICAg
ICAgICAgeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQo+
IEBAIC0yMjI2LDYgKzI3NzQsMjIgQEAgZnVuYyAoeCAqRGV2aWNlVmRpc3BsKSB0b0MoeGMgKkMu
bGlieGxfZGV2aWNlX3ZkaXNwbCkgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+
ICB9Cj4KPiArLy8gTmV3VnNuZFBhcmFtcyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZzbmRQYXJh
bXMgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdWc25kUGFyYW1zKCkgKCpW
c25kUGFyYW1zLCBlcnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAgICAgICAgICAgICAgeCAg
VnNuZFBhcmFtcwo+ICsgICAgICAgICAgICAgICB4YyBDLmxpYnhsX3ZzbmRfcGFyYW1zCj4gKyAg
ICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF92c25kX3BhcmFtc19pbml0KCZ4YykKPiArCj4g
KyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAg
ICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4
LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqVnNuZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxf
dnNuZF9wYXJhbXMpIGVycm9yIHsKPiAgICAgICAgIG51bVNhbXBsZVJhdGVzIDo9IGludCh4Yy5u
dW1fc2FtcGxlX3JhdGVzKQo+ICAgICAgICAgY1NhbXBsZVJhdGVzIDo9ICgqWzEgPDwgMjhdQy51
aW50MzJfdCkodW5zYWZlLlBvaW50ZXIoeGMuc2FtcGxlX3JhdGVzKSlbOm51bVNhbXBsZVJhdGVz
Om51bVNhbXBsZVJhdGVzXQo+IEBAIC0yMjc2LDYgKzI4NDAsMjIgQEAgZnVuYyAoeCAqVnNuZFBh
cmFtcykgdG9DKHhjICpDLmxpYnhsX3ZzbmRfcGFyYW1zKSAoZXJyIGVycm9yKSB7Cj4gICAgICAg
ICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdWc25kU3RyZWFtIHJldHVybnMgYW4gaW5zdGFu
Y2Ugb2YgVnNuZFN0cmVhbSBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld1Zz
bmRTdHJlYW0oKSAoKlZzbmRTdHJlYW0sIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAg
ICAgICAgICAgICB4ICBWc25kU3RyZWFtCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfdnNu
ZF9zdHJlYW0KPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX3ZzbmRfc3RyZWFtX2lu
aXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwg
ewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAg
ICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpWc25kU3RyZWFtKSBmcm9t
Qyh4YyAqQy5saWJ4bF92c25kX3N0cmVhbSkgZXJyb3Igewo+ICAgICAgICAgeC5VbmlxdWVJZCA9
IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQo+ICAgICAgICAgeC5UeXBlID0gVnNuZFN0cmVhbVR5
cGUoeGMuX3R5cGUpCj4gQEAgLTIzMDQsNiArMjg4NCwyMiBAQCBmdW5jICh4ICpWc25kU3RyZWFt
KSB0b0MoeGMgKkMubGlieGxfdnNuZF9zdHJlYW0pIChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJl
dHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld1ZzbmRQY20gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBW
c25kUGNtIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3VnNuZFBjbSgpICgq
VnNuZFBjbSwgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIFZz
bmRQY20KPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF92c25kX3BjbQo+ICsgICAgICAgKQo+
ICsKPiArICAgICAgIEMubGlieGxfdnNuZF9wY21faW5pdCgmeGMpCj4gKwo+ICsgICAgICAgaWYg
ZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgIHJldHVy
biBuaWwsIGVycgo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAmeCwgbmlsCj4gK30K
PiArCj4gIGZ1bmMgKHggKlZzbmRQY20pIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfcGNtKSBlcnJv
ciB7Cj4gICAgICAgICB4Lk5hbWUgPSBDLkdvU3RyaW5nKHhjLm5hbWUpCj4gICAgICAgICBpZiBl
cnIgOj0geC5QYXJhbXMuZnJvbUMoJnhjLnBhcmFtcyk7IGVyciAhPSBuaWwgewo+IEBAIC0yMzQ4
LDYgKzI5NDQsMjIgQEAgZnVuYyAoeCAqVnNuZFBjbSkgdG9DKHhjICpDLmxpYnhsX3ZzbmRfcGNt
KSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdEZXZp
Y2VWc25kIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNlVnNuZCBpbml0aWFsaXplZCB3aXRo
IGRlZmF1bHRzLgo+ICtmdW5jIE5ld0RldmljZVZzbmQoKSAoKkRldmljZVZzbmQsIGVycm9yKSB7
Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBEZXZpY2VWc25kCj4gKyAgICAg
ICAgICAgICAgIHhjIEMubGlieGxfZGV2aWNlX3ZzbmQKPiArICAgICAgICkKPiArCj4gKyAgICAg
ICBDLmxpYnhsX2RldmljZV92c25kX2luaXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4
LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBl
cnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBm
dW5jICh4ICpEZXZpY2VWc25kKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdnNuZCkgZXJyb3Ig
ewo+ICAgICAgICAgeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQo+ICAg
ICAgICAgeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQo+
IEBAIC0yNDA0LDYgKzMwMTYsMjIgQEAgZnVuYyAoeCAqRGV2aWNlVnNuZCkgdG9DKHhjICpDLmxp
YnhsX2RldmljZV92c25kKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0K
Pgo+ICsvLyBOZXdEb21haW5Db25maWcgcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEb21haW5Db25m
aWcgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdEb21haW5Db25maWcoKSAo
KkRvbWFpbkNvbmZpZywgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAgICAg
IHggIERvbWFpbkNvbmZpZwo+ICsgICAgICAgICAgICAgICB4YyBDLmxpYnhsX2RvbWFpbl9jb25m
aWcKPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX2RvbWFpbl9jb25maWdfaW5pdCgm
eGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4g
KyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAgICAgfQo+ICsKPiArICAgICAg
IHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgZnJvbUMo
eGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJyb3Igewo+ICAgICAgICAgaWYgZXJyIDo9IHgu
Q0luZm8uZnJvbUMoJnhjLmNfaW5mbyk7IGVyciAhPSBuaWwgewo+ICAgICAgICAgICAgICAgICBy
ZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDSW5mbzogJXYiLCBlcnIpCj4gQEAg
LTI3MTIsNiArMzM0MCwyMiBAQCBmdW5jICh4ICpEb21haW5Db25maWcpIHRvQyh4YyAqQy5saWJ4
bF9kb21haW5fY29uZmlnKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0K
Pgo+ICsvLyBOZXdEaXNraW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERpc2tpbmZvIGluaXRp
YWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3RGlza2luZm8oKSAoKkRpc2tpbmZvLCBl
cnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAgICAgICAgICAgICAgeCAgRGlza2luZm8KPiAr
ICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9kaXNraW5mbwo+ICsgICAgICAgKQo+ICsKPiArICAg
ICAgIEMubGlieGxfZGlza2luZm9faW5pdCgmeGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHgu
ZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVy
cgo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1
bmMgKHggKkRpc2tpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kaXNraW5mbykgZXJyb3Igewo+ICAg
ICAgICAgeC5CYWNrZW5kID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kKQo+ICAgICAgICAgeC5CYWNr
ZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKPiBAQCAtMjc0OCw2ICszMzkyLDIyIEBAIGZ1
bmMgKHggKkRpc2tpbmZvKSB0b0MoeGMgKkMubGlieGxfZGlza2luZm8pIChlcnIgZXJyb3IpIHsK
PiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld05pY2luZm8gcmV0dXJucyBhbiBp
bnN0YW5jZSBvZiBOaWNpbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3
TmljaW5mbygpICgqTmljaW5mbywgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAg
ICAgICAgIHggIE5pY2luZm8KPiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9uaWNpbmZvCj4g
KyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9uaWNpbmZvX2luaXQoJnhjKQo+ICsKPiAr
ICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAg
ICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngs
IG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpOaWNpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9uaWNp
bmZvKSBlcnJvciB7Cj4gICAgICAgICB4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQp
Cj4gICAgICAgICB4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQo+IEBAIC0yNzg2
LDYgKzM0NDYsMjIgQEAgZnVuYyAoeCAqTmljaW5mbykgdG9DKHhjICpDLmxpYnhsX25pY2luZm8p
IChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld1Z0cG1p
bmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVnRwbWluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZh
dWx0cy4KPiArZnVuYyBOZXdWdHBtaW5mbygpICgqVnRwbWluZm8sIGVycm9yKSB7Cj4gKyAgICAg
ICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBWdHBtaW5mbwo+ICsgICAgICAgICAgICAgICB4
YyBDLmxpYnhsX3Z0cG1pbmZvCj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF92dHBt
aW5mb19pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIg
IT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4g
Kwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqVnRwbWluZm8p
IGZyb21DKHhjICpDLmxpYnhsX3Z0cG1pbmZvKSBlcnJvciB7Cj4gICAgICAgICB4LkJhY2tlbmQg
PSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCj4gICAgICAgICB4LkJhY2tlbmRJZCA9IHVpbnQzMih4
Yy5iYWNrZW5kX2lkKQo+IEBAIC0yODI4LDYgKzM1MDQsMjIgQEAgZnVuYyAoeCAqVnRwbWluZm8p
IHRvQyh4YyAqQy5saWJ4bF92dHBtaW5mbykgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJu
IG5pbAo+ICB9Cj4KPiArLy8gTmV3VXNiY3RybGluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBV
c2JjdHJsaW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld1VzYmN0cmxp
bmZvKCkgKCpVc2JjdHJsaW5mbywgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAg
ICAgICAgIHggIFVzYmN0cmxpbmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfdXNiY3Ry
bGluZm8KPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX3VzYmN0cmxpbmZvX2luaXQo
JnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+
ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAgICAg
ICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpVc2JjdHJsaW5mbykgZnJvbUMo
eGMgKkMubGlieGxfdXNiY3RybGluZm8pIGVycm9yIHsKPiAgICAgICAgIHguVHlwZSA9IFVzYmN0
cmxUeXBlKHhjLl90eXBlKQo+ICAgICAgICAgeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQo+IEBA
IC0yODcyLDYgKzM1NjQsMjIgQEAgZnVuYyAoeCAqVXNiY3RybGluZm8pIHRvQyh4YyAqQy5saWJ4
bF91c2JjdHJsaW5mbykgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4K
PiArLy8gTmV3VmNwdWluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBWY3B1aW5mbyBpbml0aWFs
aXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld1ZjcHVpbmZvKCkgKCpWY3B1aW5mbywgZXJy
b3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIFZjcHVpbmZvCj4gKyAg
ICAgICAgICAgICAgIHhjIEMubGlieGxfdmNwdWluZm8KPiArICAgICAgICkKPiArCj4gKyAgICAg
ICBDLmxpYnhsX3ZjcHVpbmZvX2luaXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZy
b21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIK
PiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5j
ICh4ICpWY3B1aW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmNwdWluZm8pIGVycm9yIHsKPiAgICAg
ICAgIHguVmNwdWlkID0gdWludDMyKHhjLnZjcHVpZCkKPiAgICAgICAgIHguQ3B1ID0gdWludDMy
KHhjLmNwdSkKPiBAQCAtMjkxMiw2ICszNjIwLDIyIEBAIGZ1bmMgKHggKlZjcHVpbmZvKSB0b0Mo
eGMgKkMubGlieGxfdmNwdWluZm8pIChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwK
PiAgfQo+Cj4gKy8vIE5ld1BoeXNpbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgUGh5c2luZm8g
aW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdQaHlzaW5mbygpICgqUGh5c2lu
Zm8sIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBQaHlzaW5m
bwo+ICsgICAgICAgICAgICAgICB4YyBDLmxpYnhsX3BoeXNpbmZvCj4gKyAgICAgICApCj4gKwo+
ICsgICAgICAgQy5saWJ4bF9waHlzaW5mb19pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIg
Oj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5p
bCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsK
PiAgZnVuYyAoeCAqUGh5c2luZm8pIGZyb21DKHhjICpDLmxpYnhsX3BoeXNpbmZvKSBlcnJvciB7
Cj4gICAgICAgICB4LlRocmVhZHNQZXJDb3JlID0gdWludDMyKHhjLnRocmVhZHNfcGVyX2NvcmUp
Cj4gICAgICAgICB4LkNvcmVzUGVyU29ja2V0ID0gdWludDMyKHhjLmNvcmVzX3Blcl9zb2NrZXQp
Cj4gQEAgLTI5NzIsNiArMzY5NiwyMiBAQCBmdW5jICh4ICpQaHlzaW5mbykgdG9DKHhjICpDLmxp
YnhsX3BoeXNpbmZvKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+
ICsvLyBOZXdDb25uZWN0b3JpbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgQ29ubmVjdG9yaW5m
byBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld0Nvbm5lY3RvcmluZm8oKSAo
KkNvbm5lY3RvcmluZm8sIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAg
ICB4ICBDb25uZWN0b3JpbmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfY29ubmVjdG9y
aW5mbwo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfY29ubmVjdG9yaW5mb19pbml0
KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsK
PiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsgICAg
ICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqQ29ubmVjdG9yaW5mbykgZnJv
bUMoeGMgKkMubGlieGxfY29ubmVjdG9yaW5mbykgZXJyb3Igewo+ICAgICAgICAgeC5VbmlxdWVJ
ZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQo+ICAgICAgICAgeC5XaWR0aCA9IHVpbnQzMih4
Yy53aWR0aCkKPiBAQCAtMzAwNCw2ICszNzQ0LDIyIEBAIGZ1bmMgKHggKkNvbm5lY3RvcmluZm8p
IHRvQyh4YyAqQy5saWJ4bF9jb25uZWN0b3JpbmZvKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICBy
ZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdWZGlzcGxpbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ug
b2YgVmRpc3BsaW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld1ZkaXNw
bGluZm8oKSAoKlZkaXNwbGluZm8sIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAg
ICAgICAgICB4ICBWZGlzcGxpbmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfdmRpc3Bs
aW5mbwo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfdmRpc3BsaW5mb19pbml0KCZ4
YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKPiAr
ICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAg
cmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqVmRpc3BsaW5mbykgZnJvbUMoeGMg
KkMubGlieGxfdmRpc3BsaW5mbykgZXJyb3Igewo+ICAgICAgICAgeC5CYWNrZW5kID0gQy5Hb1N0
cmluZyh4Yy5iYWNrZW5kKQo+ICAgICAgICAgeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2Vu
ZF9pZCkKPiBAQCAtMzA1Niw2ICszODEyLDIyIEBAIGZ1bmMgKHggKlZkaXNwbGluZm8pIHRvQyh4
YyAqQy5saWJ4bF92ZGlzcGxpbmZvKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmls
Cj4gIH0KPgo+ICsvLyBOZXdTdHJlYW1pbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgU3RyZWFt
aW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld1N0cmVhbWluZm8oKSAo
KlN0cmVhbWluZm8sIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4
ICBTdHJlYW1pbmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfc3RyZWFtaW5mbwo+ICsg
ICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfc3RyZWFtaW5mb19pbml0KCZ4YykKPiArCj4g
KyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAg
ICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4
LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqU3RyZWFtaW5mbykgZnJvbUMoeGMgKkMubGlieGxf
c3RyZWFtaW5mbykgZXJyb3Igewo+ICAgICAgICAgeC5SZXFFdnRjaCA9IGludCh4Yy5yZXFfZXZ0
Y2gpCj4gICAgICAgICB4LlJlcVJyZWYgPSBpbnQoeGMucmVxX3JyZWYpCj4gQEAgLTMwNzYsNiAr
Mzg0OCwyMiBAQCBmdW5jICh4ICpTdHJlYW1pbmZvKSB0b0MoeGMgKkMubGlieGxfc3RyZWFtaW5m
bykgKGVyciBlcnJvcikgewo+ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3UGNt
aW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFBjbWluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZh
dWx0cy4KPiArZnVuYyBOZXdQY21pbmZvKCkgKCpQY21pbmZvLCBlcnJvcikgewo+ICsgICAgICAg
dmFyICgKPiArICAgICAgICAgICAgICAgeCAgUGNtaW5mbwo+ICsgICAgICAgICAgICAgICB4YyBD
LmxpYnhsX3BjbWluZm8KPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX3BjbWluZm9f
aW5pdCgmeGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5p
bCB7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgo+ICsgICAgICAgfQo+ICsKPiAr
ICAgICAgIHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4gIGZ1bmMgKHggKlBjbWluZm8pIGZyb21D
KHhjICpDLmxpYnhsX3BjbWluZm8pIGVycm9yIHsKPiAgICAgICAgIG51bVZzbmRTdHJlYW1zIDo9
IGludCh4Yy5udW1fdnNuZF9zdHJlYW1zKQo+ICAgICAgICAgY1N0cmVhbXMgOj0gKCpbMSA8PCAy
OF1DLmxpYnhsX3N0cmVhbWluZm8pKHVuc2FmZS5Qb2ludGVyKHhjLnN0cmVhbXMpKVs6bnVtVnNu
ZFN0cmVhbXM6bnVtVnNuZFN0cmVhbXNdCj4gQEAgLTMxMTAsNiArMzg5OCwyMiBAQCBmdW5jICh4
ICpQY21pbmZvKSB0b0MoeGMgKkMubGlieGxfcGNtaW5mbykgKGVyciBlcnJvcikgewo+ICAgICAg
ICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3VnNuZGluZm8gcmV0dXJucyBhbiBpbnN0YW5j
ZSBvZiBWc25kaW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld1ZzbmRp
bmZvKCkgKCpWc25kaW5mbywgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAg
ICAgIHggIFZzbmRpbmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfdnNuZGluZm8KPiAr
ICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX3ZzbmRpbmZvX2luaXQoJnhjKQo+ICsKPiAr
ICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAg
ICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngs
IG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpWc25kaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnNu
ZGluZm8pIGVycm9yIHsKPiAgICAgICAgIHguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2Vu
ZCkKPiAgICAgICAgIHguQmFja2VuZElkID0gdWludDMyKHhjLmJhY2tlbmRfaWQpCj4gQEAgLTMx
NjAsNiArMzk2NCwyMiBAQCBmdW5jICh4ICpWc25kaW5mbykgdG9DKHhjICpDLmxpYnhsX3ZzbmRp
bmZvKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdW
a2JpbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVmtiaW5mbyBpbml0aWFsaXplZCB3aXRoIGRl
ZmF1bHRzLgo+ICtmdW5jIE5ld1ZrYmluZm8oKSAoKlZrYmluZm8sIGVycm9yKSB7Cj4gKyAgICAg
ICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBWa2JpbmZvCj4gKyAgICAgICAgICAgICAgIHhj
IEMubGlieGxfdmtiaW5mbwo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfdmtiaW5m
b19pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0g
bmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+
ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqVmtiaW5mbykgZnJv
bUMoeGMgKkMubGlieGxfdmtiaW5mbykgZXJyb3Igewo+ICAgICAgICAgeC5CYWNrZW5kID0gQy5H
b1N0cmluZyh4Yy5iYWNrZW5kKQo+ICAgICAgICAgeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFj
a2VuZF9pZCkKPiBAQCAtMzE5Niw2ICs0MDE2LDIyIEBAIGZ1bmMgKHggKlZrYmluZm8pIHRvQyh4
YyAqQy5saWJ4bF92a2JpbmZvKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1cm4gbmlsCj4g
IH0KPgo+ICsvLyBOZXdOdW1haW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIE51bWFpbmZvIGlu
aXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCj4gK2Z1bmMgTmV3TnVtYWluZm8oKSAoKk51bWFpbmZv
LCBlcnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAgICAgICAgICAgICAgeCAgTnVtYWluZm8K
PiArICAgICAgICAgICAgICAgeGMgQy5saWJ4bF9udW1haW5mbwo+ICsgICAgICAgKQo+ICsKPiAr
ICAgICAgIEMubGlieGxfbnVtYWluZm9faW5pdCgmeGMpCj4gKwo+ICsgICAgICAgaWYgZXJyIDo9
IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBuaWws
IGVycgo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAmeCwgbmlsCj4gK30KPiArCj4g
IGZ1bmMgKHggKk51bWFpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9udW1haW5mbykgZXJyb3Igewo+
ICAgICAgICAgeC5TaXplID0gdWludDY0KHhjLnNpemUpCj4gICAgICAgICB4LkZyZWUgPSB1aW50
NjQoeGMuZnJlZSkKPiBAQCAtMzIzMCw2ICs0MDY2LDIyIEBAIGZ1bmMgKHggKk51bWFpbmZvKSB0
b0MoeGMgKkMubGlieGxfbnVtYWluZm8pIChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBu
aWwKPiAgfQo+Cj4gKy8vIE5ld0NwdXRvcG9sb2d5IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgQ3B1
dG9wb2xvZ3kgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdDcHV0b3BvbG9n
eSgpICgqQ3B1dG9wb2xvZ3ksIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAg
ICAgICB4ICBDcHV0b3BvbG9neQo+ICsgICAgICAgICAgICAgICB4YyBDLmxpYnhsX2NwdXRvcG9s
b2d5Cj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9jcHV0b3BvbG9neV9pbml0KCZ4
YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKPiAr
ICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAg
cmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqQ3B1dG9wb2xvZ3kpIGZyb21DKHhj
ICpDLmxpYnhsX2NwdXRvcG9sb2d5KSBlcnJvciB7Cj4gICAgICAgICB4LkNvcmUgPSB1aW50MzIo
eGMuY29yZSkKPiAgICAgICAgIHguU29ja2V0ID0gdWludDMyKHhjLnNvY2tldCkKPiBAQCAtMzI1
Miw2ICs0MTA0LDIyIEBAIGZ1bmMgKHggKkNwdXRvcG9sb2d5KSB0b0MoeGMgKkMubGlieGxfY3B1
dG9wb2xvZ3kpIChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8v
IE5ld1BjaXRvcG9sb2d5IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgUGNpdG9wb2xvZ3kgaW5pdGlh
bGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdQY2l0b3BvbG9neSgpICgqUGNpdG9wb2xv
Z3ksIGVycm9yKSB7Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBQY2l0b3Bv
bG9neQo+ICsgICAgICAgICAgICAgICB4YyBDLmxpYnhsX3BjaXRvcG9sb2d5Cj4gKyAgICAgICAp
Cj4gKwo+ICsgICAgICAgQy5saWJ4bF9wY2l0b3BvbG9neV9pbml0KCZ4YykKPiArCj4gKyAgICAg
ICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAg
cmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwK
PiArfQo+ICsKPiAgZnVuYyAoeCAqUGNpdG9wb2xvZ3kpIGZyb21DKHhjICpDLmxpYnhsX3BjaXRv
cG9sb2d5KSBlcnJvciB7Cj4gICAgICAgICB4LlNlZyA9IHVpbnQxNih4Yy5zZWcpCj4gICAgICAg
ICB4LkJ1cyA9IGJ5dGUoeGMuYnVzKQo+IEBAIC0zMjc2LDYgKzQxNDQsMjIgQEAgZnVuYyAoeCAq
UGNpdG9wb2xvZ3kpIHRvQyh4YyAqQy5saWJ4bF9wY2l0b3BvbG9neSkgKGVyciBlcnJvcikgewo+
ICAgICAgICAgcmV0dXJuIG5pbAo+ICB9Cj4KPiArLy8gTmV3U2NoZWRDcmVkaXRQYXJhbXMgcmV0
dXJucyBhbiBpbnN0YW5jZSBvZiBTY2hlZENyZWRpdFBhcmFtcyBpbml0aWFsaXplZCB3aXRoIGRl
ZmF1bHRzLgo+ICtmdW5jIE5ld1NjaGVkQ3JlZGl0UGFyYW1zKCkgKCpTY2hlZENyZWRpdFBhcmFt
cywgZXJyb3IpIHsKPiArICAgICAgIHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIFNjaGVkQ3Jl
ZGl0UGFyYW1zCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFt
cwo+ICsgICAgICAgKQo+ICsKPiArICAgICAgIEMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFtc19p
bml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmls
IHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAgICAgICB9Cj4gKwo+ICsg
ICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAqU2NoZWRDcmVkaXRQYXJh
bXMpIGZyb21DKHhjICpDLmxpYnhsX3NjaGVkX2NyZWRpdF9wYXJhbXMpIGVycm9yIHsKPiAgICAg
ICAgIHguVHNsaWNlTXMgPSBpbnQoeGMudHNsaWNlX21zKQo+ICAgICAgICAgeC5SYXRlbGltaXRV
cyA9IGludCh4Yy5yYXRlbGltaXRfdXMpCj4gQEAgLTMyOTIsNiArNDE3NiwyMiBAQCBmdW5jICh4
ICpTY2hlZENyZWRpdFBhcmFtcykgdG9DKHhjICpDLmxpYnhsX3NjaGVkX2NyZWRpdF9wYXJhbXMp
IChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld1NjaGVk
Q3JlZGl0MlBhcmFtcyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFNjaGVkQ3JlZGl0MlBhcmFtcyBp
bml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgo+ICtmdW5jIE5ld1NjaGVkQ3JlZGl0MlBhcmFtcygp
ICgqU2NoZWRDcmVkaXQyUGFyYW1zLCBlcnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAgICAg
ICAgICAgICAgeCAgU2NoZWRDcmVkaXQyUGFyYW1zCj4gKyAgICAgICAgICAgICAgIHhjIEMubGli
eGxfc2NoZWRfY3JlZGl0Ml9wYXJhbXMKPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhs
X3NjaGVkX2NyZWRpdDJfcGFyYW1zX2luaXQoJnhjKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4
LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBl
cnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBm
dW5jICh4ICpTY2hlZENyZWRpdDJQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX3NjaGVkX2NyZWRp
dDJfcGFyYW1zKSBlcnJvciB7Cj4gICAgICAgICB4LlJhdGVsaW1pdFVzID0gaW50KHhjLnJhdGVs
aW1pdF91cykKPgo+IEBAIC0zMzA0LDYgKzQyMDQsMjIgQEAgZnVuYyAoeCAqU2NoZWRDcmVkaXQy
UGFyYW1zKSB0b0MoeGMgKkMubGlieGxfc2NoZWRfY3JlZGl0Ml9wYXJhbXMpIChlcnIgZXJyb3Ip
IHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld0RvbWFpblJlbXVzSW5mbyBy
ZXR1cm5zIGFuIGluc3RhbmNlIG9mIERvbWFpblJlbXVzSW5mbyBpbml0aWFsaXplZCB3aXRoIGRl
ZmF1bHRzLgo+ICtmdW5jIE5ld0RvbWFpblJlbXVzSW5mbygpICgqRG9tYWluUmVtdXNJbmZvLCBl
cnJvcikgewo+ICsgICAgICAgdmFyICgKPiArICAgICAgICAgICAgICAgeCAgRG9tYWluUmVtdXNJ
bmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGlieGxfZG9tYWluX3JlbXVzX2luZm8KPiArICAg
ICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvX2luaXQoJnhjKQo+
ICsKPiArICAgICAgIGlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAg
ICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1
cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBmdW5jICh4ICpEb21haW5SZW11c0luZm8pIGZyb21DKHhj
ICpDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvKSBlcnJvciB7Cj4gICAgICAgICB4LkludGVydmFs
ID0gaW50KHhjLmludGVydmFsKQo+ICAgICAgICAgaWYgZXJyIDo9IHguQWxsb3dVbnNhZmUuZnJv
bUMoJnhjLmFsbG93X3Vuc2FmZSk7IGVyciAhPSBuaWwgewo+IEBAIC0zMzY4LDYgKzQyODQsMjMg
QEAgZnVuYyAoeCAqRG9tYWluUmVtdXNJbmZvKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX3JlbXVz
X2luZm8pIChlcnIgZXJyb3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5l
d0V2ZW50IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRXZlbnQgaW5pdGlhbGl6ZWQgd2l0aCBkZWZh
dWx0cy4KPiArZnVuYyBOZXdFdmVudChldHlwZSBFdmVudFR5cGUpICgqRXZlbnQsIGVycm9yKSB7
Cj4gKyAgICAgICB2YXIgKAo+ICsgICAgICAgICAgICAgICB4ICBFdmVudAo+ICsgICAgICAgICAg
ICAgICB4YyBDLmxpYnhsX2V2ZW50Cj4gKyAgICAgICApCj4gKwo+ICsgICAgICAgQy5saWJ4bF9l
dmVudF9pbml0KCZ4YykKPiArICAgICAgIEMubGlieGxfZXZlbnRfaW5pdF90eXBlKCZ4YywgQy5s
aWJ4bF9ldmVudF90eXBlKGV0eXBlKSkKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygm
eGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAg
ICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAq
RXZlbnQpIGZyb21DKHhjICpDLmxpYnhsX2V2ZW50KSBlcnJvciB7Cj4gICAgICAgICBpZiBlcnIg
Oj0geC5MaW5rLmZyb21DKCZ4Yy5saW5rKTsgZXJyICE9IG5pbCB7Cj4gICAgICAgICAgICAgICAg
IHJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIExpbms6ICV2IiwgZXJyKQo+IEBA
IC0zMzc5LDYgKzQzMTIsMTIgQEAgZnVuYyAoeCAqRXZlbnQpIGZyb21DKHhjICpDLmxpYnhsX2V2
ZW50KSBlcnJvciB7Cj4gICAgICAgICB4LkZvclVzZXIgPSB1aW50NjQoeGMuZm9yX3VzZXIpCj4g
ICAgICAgICB4LlR5cGUgPSBFdmVudFR5cGUoeGMuX3R5cGUpCj4gICAgICAgICBzd2l0Y2ggeC5U
eXBlIHsKPiArICAgICAgIGNhc2UgRXZlbnRUeXBlT3BlcmF0aW9uQ29tcGxldGU6Cj4gKyAgICAg
ICAgICAgICAgIHZhciB0eXBlT3BlcmF0aW9uQ29tcGxldGUgRXZlbnRUeXBlVW5pb25PcGVyYXRp
b25Db21wbGV0ZQo+ICsgICAgICAgICAgICAgICBpZiBlcnIgOj0gdHlwZU9wZXJhdGlvbkNvbXBs
ZXRlLmZyb21DKHhjKTsgZXJyICE9IG5pbCB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgdHlwZU9wZXJhdGlvbkNvbXBsZXRlOiAl
diIsIGVycikKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAgICAgICAgICB4LlR5cGVVbmlv
biA9IHR5cGVPcGVyYXRpb25Db21wbGV0ZQo+ICAgICAgICAgY2FzZSBFdmVudFR5cGVEb21haW5T
aHV0ZG93bjoKPiAgICAgICAgICAgICAgICAgdmFyIHR5cGVEb21haW5TaHV0ZG93biBFdmVudFR5
cGVVbmlvbkRvbWFpblNodXRkb3duCj4gICAgICAgICAgICAgICAgIGlmIGVyciA6PSB0eXBlRG9t
YWluU2h1dGRvd24uZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKPiBAQCAtMzM5MSwxMiArNDMzMCw2
IEBAIGZ1bmMgKHggKkV2ZW50KSBmcm9tQyh4YyAqQy5saWJ4bF9ldmVudCkgZXJyb3Igewo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxk
IHR5cGVEaXNrRWplY3Q6ICV2IiwgZXJyKQo+ICAgICAgICAgICAgICAgICB9Cj4gICAgICAgICAg
ICAgICAgIHguVHlwZVVuaW9uID0gdHlwZURpc2tFamVjdAo+IC0gICAgICAgY2FzZSBFdmVudFR5
cGVPcGVyYXRpb25Db21wbGV0ZToKPiAtICAgICAgICAgICAgICAgdmFyIHR5cGVPcGVyYXRpb25D
b21wbGV0ZSBFdmVudFR5cGVVbmlvbk9wZXJhdGlvbkNvbXBsZXRlCj4gLSAgICAgICAgICAgICAg
IGlmIGVyciA6PSB0eXBlT3BlcmF0aW9uQ29tcGxldGUuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsK
PiAtICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBm
aWVsZCB0eXBlT3BlcmF0aW9uQ29tcGxldGU6ICV2IiwgZXJyKQo+IC0gICAgICAgICAgICAgICB9
Cj4gLSAgICAgICAgICAgICAgIHguVHlwZVVuaW9uID0gdHlwZU9wZXJhdGlvbkNvbXBsZXRlCj4g
ICAgICAgICBkZWZhdWx0Ogo+ICAgICAgICAgICAgICAgICByZXR1cm4gZm10LkVycm9yZigiaW52
YWxpZCB1bmlvbiBrZXkgJyV2JyIsIHguVHlwZSkKPiAgICAgICAgIH0KPiBAQCAtMzQ5Myw2ICs0
NDI2LDIyIEBAIGZ1bmMgKHggKkV2ZW50KSB0b0MoeGMgKkMubGlieGxfZXZlbnQpIChlcnIgZXJy
b3IpIHsKPiAgICAgICAgIHJldHVybiBuaWwKPiAgfQo+Cj4gKy8vIE5ld1BzckNhdEluZm8gcmV0
dXJucyBhbiBpbnN0YW5jZSBvZiBQc3JDYXRJbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMu
Cj4gK2Z1bmMgTmV3UHNyQ2F0SW5mbygpICgqUHNyQ2F0SW5mbywgZXJyb3IpIHsKPiArICAgICAg
IHZhciAoCj4gKyAgICAgICAgICAgICAgIHggIFBzckNhdEluZm8KPiArICAgICAgICAgICAgICAg
eGMgQy5saWJ4bF9wc3JfY2F0X2luZm8KPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhs
X3Bzcl9jYXRfaW5mb19pbml0KCZ4YykKPiArCj4gKyAgICAgICBpZiBlcnIgOj0geC5mcm9tQygm
eGMpOyBlcnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCj4gKyAg
ICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuICZ4LCBuaWwKPiArfQo+ICsKPiAgZnVuYyAoeCAq
UHNyQ2F0SW5mbykgZnJvbUMoeGMgKkMubGlieGxfcHNyX2NhdF9pbmZvKSBlcnJvciB7Cj4gICAg
ICAgICB4LklkID0gdWludDMyKHhjLmlkKQo+ICAgICAgICAgeC5Db3NNYXggPSB1aW50MzIoeGMu
Y29zX21heCkKPiBAQCAtMzUxNywyMiArNDQ2NiwzOSBAQCBmdW5jICh4ICpQc3JDYXRJbmZvKSB0
b0MoeGMgKkMubGlieGxfcHNyX2NhdF9pbmZvKSAoZXJyIGVycm9yKSB7Cj4gICAgICAgICByZXR1
cm4gbmlsCj4gIH0KPgo+ICsvLyBOZXdQc3JId0luZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBQ
c3JId0luZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KPiArZnVuYyBOZXdQc3JId0luZm8o
cHR5cGUgUHNyRmVhdFR5cGUpICgqUHNySHdJbmZvLCBlcnJvcikgewo+ICsgICAgICAgdmFyICgK
PiArICAgICAgICAgICAgICAgeCAgUHNySHdJbmZvCj4gKyAgICAgICAgICAgICAgIHhjIEMubGli
eGxfcHNyX2h3X2luZm8KPiArICAgICAgICkKPiArCj4gKyAgICAgICBDLmxpYnhsX3Bzcl9od19p
bmZvX2luaXQoJnhjKQo+ICsgICAgICAgQy5saWJ4bF9wc3JfaHdfaW5mb19pbml0X3R5cGUoJnhj
LCBDLmxpYnhsX3Bzcl9mZWF0X3R5cGUocHR5cGUpKQo+ICsKPiArICAgICAgIGlmIGVyciA6PSB4
LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewo+ICsgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBl
cnIKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gJngsIG5pbAo+ICt9Cj4gKwo+ICBm
dW5jICh4ICpQc3JId0luZm8pIGZyb21DKHhjICpDLmxpYnhsX3Bzcl9od19pbmZvKSBlcnJvciB7
Cj4gICAgICAgICB4LklkID0gdWludDMyKHhjLmlkKQo+ICAgICAgICAgeC5UeXBlID0gUHNyRmVh
dFR5cGUoeGMuX3R5cGUpCj4gICAgICAgICBzd2l0Y2ggeC5UeXBlIHsKPiAtICAgICAgIGNhc2Ug
UHNyRmVhdFR5cGVDYXQ6Cj4gLSAgICAgICAgICAgICAgIHZhciB0eXBlQ2F0IFBzckh3SW5mb1R5
cGVVbmlvbkNhdAo+IC0gICAgICAgICAgICAgICBpZiBlcnIgOj0gdHlwZUNhdC5mcm9tQyh4Yyk7
IGVyciAhPSBuaWwgewo+IC0gICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmbXQuRXJyb3Jm
KCJjb252ZXJ0aW5nIGZpZWxkIHR5cGVDYXQ6ICV2IiwgZXJyKQo+IC0gICAgICAgICAgICAgICB9
Cj4gLSAgICAgICAgICAgICAgIHguVHlwZVVuaW9uID0gdHlwZUNhdAo+ICAgICAgICAgY2FzZSBQ
c3JGZWF0VHlwZU1iYToKPiAgICAgICAgICAgICAgICAgdmFyIHR5cGVNYmEgUHNySHdJbmZvVHlw
ZVVuaW9uTWJhCj4gICAgICAgICAgICAgICAgIGlmIGVyciA6PSB0eXBlTWJhLmZyb21DKHhjKTsg
ZXJyICE9IG5pbCB7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgdHlwZU1iYTogJXYiLCBlcnIpCj4gICAgICAgICAgICAgICAgIH0K
PiAgICAgICAgICAgICAgICAgeC5UeXBlVW5pb24gPSB0eXBlTWJhCj4gKyAgICAgICBjYXNlIFBz
ckZlYXRUeXBlQ2F0Ogo+ICsgICAgICAgICAgICAgICB2YXIgdHlwZUNhdCBQc3JId0luZm9UeXBl
VW5pb25DYXQKPiArICAgICAgICAgICAgICAgaWYgZXJyIDo9IHR5cGVDYXQuZnJvbUMoeGMpOyBl
cnIgIT0gbmlsIHsKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm10LkVycm9yZigi
Y29udmVydGluZyBmaWVsZCB0eXBlQ2F0OiAldiIsIGVycikKPiArICAgICAgICAgICAgICAgfQo+
ICsgICAgICAgICAgICAgICB4LlR5cGVVbmlvbiA9IHR5cGVDYXQKPiAgICAgICAgIGRlZmF1bHQ6
Cj4gICAgICAgICAgICAgICAgIHJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlkIHVuaW9uIGtleSAn
JXYnIiwgeC5UeXBlKQo+ICAgICAgICAgfQo+IC0tCj4gMi4xNy4xCj4KCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QK
WGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5v
cmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

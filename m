Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id BE81234736
	for <lists+xen-devel@lfdr.de>; Tue,  4 Jun 2019 14:46:32 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hY8n1-0002U6-Uf; Tue, 04 Jun 2019 12:43:43 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=8ILU=UD=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1hY8n0-0002Tr-7a
 for xen-devel@lists.xenproject.org; Tue, 04 Jun 2019 12:43:42 +0000
X-Inumbo-ID: 6072f7d4-86c6-11e9-a6c0-23286d6a6a4a
Received: from prv1-mh.provo.novell.com (unknown [137.65.248.33])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 6072f7d4-86c6-11e9-a6c0-23286d6a6a4a;
 Tue, 04 Jun 2019 12:43:39 +0000 (UTC)
Received: from INET-PRV1-MTA by prv1-mh.provo.novell.com
 with Novell_GroupWise; Tue, 04 Jun 2019 06:43:38 -0600
Message-Id: <5CF667780200007800235142@prv1-mh.provo.novell.com>
X-Mailer: Novell GroupWise Internet Agent 18.1.1 
Date: Tue, 04 Jun 2019 06:43:36 -0600
From: "Jan Beulich" <JBeulich@suse.com>
To: "xen-devel" <xen-devel@lists.xenproject.org>
References: <5CF664580200007800235089@prv1-mh.provo.novell.com>
In-Reply-To: <5CF664580200007800235089@prv1-mh.provo.novell.com>
Mime-Version: 1.0
Content-Disposition: inline
Subject: [Xen-devel] [PATCH v2 3/4] adjust special domain creation (and call
 it earlier on x86)
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, WeiLiu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <Ian.Jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Roger Pau Monne <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

U3BsaXQgb3V0IHRoaXMgbW9zdGx5IGFyY2gtaW5kZXBlbmRlbnQgY29kZSBpbnRvIGEgY29tbW9u
LWNvZGUgaGVscGVyCmZ1bmN0aW9uLiAoVGhpcyBkb2VzIGF3YXkgd2l0aCBBcm0ncyBhcmNoX2lu
aXRfbWVtb3J5KCkgYWx0b2dldGhlci4pCgpPbiB4ODYgdGhpcyBuZWVkcyB0byBoYXBwZW4gYmVm
b3JlIGFjcGlfYm9vdF9pbml0KCk6IENvbW1pdCA5ZmE5NGUxMDU4CigieDg2L0FDUEk6IGFsc28g
cGFyc2UgQU1EIElPTU1VIHRhYmxlcyBlYXJseSIpIG9ubHkgYXBwZWFyZWQgdG8gd29yawpmaW5l
IC0gaXQncyByZWFsbHkgYnJva2VuLCBhbmQgZG9lc24ndCBjcmFzaCAob24gbm9uLUVGSSBBTUQg
c3lzdGVtcykKb25seSBiZWNhdXNlIG9mIHRoZXJlIGJlaW5nIGEgbWFwcGluZyBvZiBsaW5lYXIg
YWRkcmVzcyAwIGR1cmluZyBlYXJseQpib290LiBPbiBFRkkgdGhlcmUgaXM6CgogRWFybHkgZmF0
YWwgcGFnZSBmYXVsdCBhdCBlMDA4OmZmZmY4MmQwODAyNGQ1OGUgKGNyMj0wMDAwMDAwMDAwMDAw
MjIwLCBlYz0wMDAwKQogLS0tLVsgWGVuLTQuMTMtdW5zdGFibGUgIHg4Nl82NCAgZGVidWc9eSAg
IE5vdCB0YWludGVkIF0tLS0tCiBDUFU6ICAgIDAKIFJJUDogICAgZTAwODpbPGZmZmY4MmQwODAy
NGQ1OGU+XSBwY2kuYyNfcGNpX2hpZGVfZGV2aWNlKzB4MTcvMHgzYQogUkZMQUdTOiAwMDAwMDAw
MDAwMDEwMDQ2ICAgQ09OVEVYVDogaHlwZXJ2aXNvcgogcmF4OiAwMDAwMDAwMDAwMDAwMDAwICAg
cmJ4OiAwMDAwMDAwMDAwMDA2MDAwICAgcmN4OiAwMDAwMDAwMDAwMDAwMDAwCiByZHg6IGZmZmY4
MzEwNGYyZWU5YjAgICByc2k6IGZmZmY4MmUwMjA5ZTVkNDggICByZGk6IGZmZmY4MzEwNGYyZWU5
YTAKIHJicDogZmZmZjgyZDA4MDgxZmNlMCAgIHJzcDogZmZmZjgyZDA4MDgxZmNiOCAgIHI4OiAg
MDAwMDAwMDAwMDAwMDAwMAogcjk6ICA4MDAwMDAwMDAwMDAwMDAwICAgcjEwOiAwMTgwMDAwMDAw
MDAwMDAwICAgcjExOiA3ZmZmZmZmZmZmZmZmZmZmCiByMTI6IGZmZmY4MzEwNGYyZWU5YTAgICBy
MTM6IDAwMDAwMDAwMDAwMDAwMDIgICByMTQ6IGZmZmY4MzEwNGYyZWU0YjAKIHIxNTogMDAwMDAw
MDAwMDAwMDA2NCAgIGNyMDogMDAwMDAwMDA4MDA1MDAzMyAgIGNyNDogMDAwMDAwMDAwMDAwMDBh
MAogY3IzOiAwMDAwMDAwMDlmNjE0MDAwICAgY3IyOiAwMDAwMDAwMDAwMDAwMjIwCiBmc2I6IDAw
MDAwMDAwMDAwMDAwMDAgICBnc2I6IDAwMDAwMDAwMDAwMDAwMDAgICBnc3M6IDAwMDAwMDAwMDAw
MDAwMDAKIGRzOiAwMDAwICAgZXM6IDAwMDAgICBmczogMDAwMCAgIGdzOiAwMDAwICAgc3M6IDAw
MDAgICBjczogZTAwOAogWGVuIGNvZGUgYXJvdW5kIDxmZmZmODJkMDgwMjRkNThlPiAocGNpLmMj
X3BjaV9oaWRlX2RldmljZSsweDE3LzB4M2EpOgogIDQ4IDg5IDQ3IDM4IDQ4IDhkIDU3IDEwIDw0
OD4gOGIgODggMjAgMDIgMDAgMDAgNDggODkgNTEgMDggNDggODkgNGYgMTAgNDgKIFhlbiBzdGFj
ayB0cmFjZSBmcm9tIHJzcD1mZmZmODJkMDgwODFmY2I4OgpbLi4uXQogWGVuIGNhbGwgdHJhY2U6
CiAgICBbPGZmZmY4MmQwODAyNGQ1OGU+XSBwY2kuYyNfcGNpX2hpZGVfZGV2aWNlKzB4MTcvMHgz
YQpbICAgWzwgICAgICAgICAgICAgICAgPl0gcGNpX3JvX2RldmljZSsuLi5dCiAgICBbPGZmZmY4
MmQwODA2MTdmZTE+XSBhbWRfaW9tbXVfZGV0ZWN0X29uZV9hY3BpKzB4MTYxLzB4MjQ5CiAgICBb
PGZmZmY4MmQwODA2MTg2YWM+XSBpb21tdV9hY3BpLmMjZGV0ZWN0X2lvbW11X2FjcGkrMHhiNS8w
eGU3CiAgICBbPGZmZmY4MmQwODA2MWNkZTA+XSBhY3BpX3RhYmxlX3BhcnNlKzB4NjEvMHg5MAog
ICAgWzxmZmZmODJkMDgwNjE5ZTdkPl0gYW1kX2lvbW11X2RldGVjdF9hY3BpKzB4MTcvMHgxOQog
ICAgWzxmZmZmODJkMDgwNjE3OTBiPl0gYWNwaV9pdnJzX2luaXQrMHgyMC8weDViCiAgICBbPGZm
ZmY4MmQwODA2MmU4Mzg+XSBhY3BpX2Jvb3RfaW5pdCsweDMwMS8weDMwZgogICAgWzxmZmZmODJk
MDgwNjI4YjEwPl0gX19zdGFydF94ZW4rMHgxZGFmLzB4MjhhMgogCiBQYWdldGFibGUgd2FsayBm
cm9tIDAwMDAwMDAwMDAwMDAyMjA6CiAgTDRbMHgwMDBdID0gMDAwMDAwMDA5ZjQ0ZjA2MyBmZmZm
ZmZmZmZmZmZmZmZmCiAgTDNbMHgwMDBdID0gMDAwMDAwMDA5ZjQ0YjA2MyBmZmZmZmZmZmZmZmZm
ZmZmCiAgTDJbMHgwMDBdID0gMDAwMDAwMDAwMDAwMDAwMCBmZmZmZmZmZmZmZmZmZmZmCiAKICoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKIFBhbmljIG9uIENQVSAwOgog
RkFUQUwgVFJBUDogdmVjdG9yID0gMTQgKHBhZ2UgZmF1bHQpCiBbZXJyb3JfY29kZT0wMDAwXSAs
IElOIElOVEVSUlVQVCBDT05URVhUCiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqCgpPZiBjb3Vyc2UgdGhlIGJ1ZyB3b3VsZCBuZXZlcnRoZWxlc3MgaGF2ZSBsZWFkIHRv
IHBvc3QtYm9vdCBjcmFzaGVzIGFzCnNvb24gYXMgdGhlIGxpc3Qgd291bGQgYWN0dWFsbHkgZ2V0
IHRyYXZlcnNlZC4KClRha2UgdGhlIG9wcG9ydHVuaXR5IGFuZAotIGNvbnZlcnQgQlVHX09OKClz
IGJlaW5nIG1vdmVkIHRvIHBhbmljKCksCi0gYWRkIF9fcmVhZF9tb3N0bHkgYW5ub3RhdGlvbnMg
dG8gdGhlIGRvbV8qIGRlZmluaXRpb25zLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpi
ZXVsaWNoQHN1c2UuY29tPgotLS0KdjI6IFJlLWJhc2Ugb3ZlciBwZGV2X2xpc3QgbW92ZW1lbnQg
cGF0Y2guIFJlcGxhY2UgQlVHX09OKCkuIERyb3Agc3RyYXkKYmxhbmsgbGluZSBpbnNlcnRpb24u
CgotLS0gYS94ZW4vYXJjaC9hcm0vbW0uYworKysgYi94ZW4vYXJjaC9hcm0vbW0uYwpAQCAtNDIs
OCArNDIsNiBAQAogI2luY2x1ZGUgPHhlbi9saWJmZHQvbGliZmR0Lmg+CiAjaW5jbHVkZSA8YXNt
L3NldHVwLmg+CiAKLXN0cnVjdCBkb21haW4gKmRvbV94ZW4sICpkb21faW8sICpkb21fY293Owot
CiAvKiBPdmVycmlkZSBtYWNyb3MgZnJvbSBhc20vcGFnZS5oIHRvIG1ha2UgdGhlbSB3b3JrIHdp
dGggbWZuX3QgKi8KICN1bmRlZiB2aXJ0X3RvX21mbgogI2RlZmluZSB2aXJ0X3RvX21mbih2YSkg
X21mbihfX3ZpcnRfdG9fbWZuKHZhKSkKQEAgLTUxMywzMiArNTExLDYgQEAgdm9pZCBmbHVzaF9w
YWdlX3RvX3JhbSh1bnNpZ25lZCBsb25nIG1mbgogICAgICAgICBpbnZhbGlkYXRlX2ljYWNoZSgp
OwogfQogCi12b2lkIF9faW5pdCBhcmNoX2luaXRfbWVtb3J5KHZvaWQpCi17Ci0gICAgLyoKLSAg
ICAgKiBJbml0aWFsaXNlIG91ciBET01JRF9YRU4gZG9tYWluLgotICAgICAqIEFueSBYZW4taGVh
cCBwYWdlcyB0aGF0IHdlIHdpbGwgYWxsb3cgdG8gYmUgbWFwcGVkIHdpbGwgaGF2ZQotICAgICAq
IHRoZWlyIGRvbWFpbiBmaWVsZCBzZXQgdG8gZG9tX3hlbi4KLSAgICAgKi8KLSAgICBkb21feGVu
ID0gZG9tYWluX2NyZWF0ZShET01JRF9YRU4sIE5VTEwsIGZhbHNlKTsKLSAgICBCVUdfT04oSVNf
RVJSKGRvbV94ZW4pKTsKLQotICAgIC8qCi0gICAgICogSW5pdGlhbGlzZSBvdXIgRE9NSURfSU8g
ZG9tYWluLgotICAgICAqIFRoaXMgZG9tYWluIG93bnMgSS9PIHBhZ2VzIHRoYXQgYXJlIHdpdGhp
biB0aGUgcmFuZ2Ugb2YgdGhlIHBhZ2VfaW5mbwotICAgICAqIGFycmF5LiBNYXBwaW5ncyBvY2N1
ciBhdCB0aGUgcHJpdiBvZiB0aGUgY2FsbGVyLgotICAgICAqLwotICAgIGRvbV9pbyA9IGRvbWFp
bl9jcmVhdGUoRE9NSURfSU8sIE5VTEwsIGZhbHNlKTsKLSAgICBCVUdfT04oSVNfRVJSKGRvbV9p
bykpOwotCi0gICAgLyoKLSAgICAgKiBJbml0aWFsaXNlIG91ciBDT1cgZG9tYWluLgotICAgICAq
IFRoaXMgZG9tYWluIG93bnMgc2hhcmFibGUgcGFnZXMuCi0gICAgICovCi0gICAgZG9tX2NvdyA9
IGRvbWFpbl9jcmVhdGUoRE9NSURfQ09XLCBOVUxMLCBmYWxzZSk7Ci0gICAgQlVHX09OKElTX0VS
Uihkb21fY293KSk7Ci19Ci0KIHN0YXRpYyBpbmxpbmUgbHBhZV90IHB0ZV9vZl94ZW5hZGRyKHZh
ZGRyX3QgdmEpCiB7CiAgICAgcGFkZHJfdCBtYSA9IHZhICsgcGh5c19vZmZzZXQ7Ci0tLSBhL3hl
bi9hcmNoL2FybS9zZXR1cC5jCisrKyBiL3hlbi9hcmNoL2FybS9zZXR1cC5jCkBAIC04NDYsNyAr
ODQ2LDcgQEAgdm9pZCBfX2luaXQgc3RhcnRfeGVuKHVuc2lnbmVkIGxvbmcgYm9vdAogCiAgICAg
cmN1X2luaXQoKTsKIAotICAgIGFyY2hfaW5pdF9tZW1vcnkoKTsKKyAgICBzZXR1cF9zcGVjaWFs
X2RvbWFpbnMoKTsKIAogICAgIGxvY2FsX2lycV9lbmFibGUoKTsKICAgICBsb2NhbF9hYm9ydF9l
bmFibGUoKTsKLS0tIGEveGVuL2FyY2gveDg2L21tLmMKKysrIGIveGVuL2FyY2gveDg2L21tLmMK
QEAgLTE2MCw5ICsxNjAsNiBAQCBsMV9wZ2VudHJ5X3QgX19zZWN0aW9uKCIuYnNzLnBhZ2VfYWxp
Z25lCiAKIHBhZGRyX3QgX19yZWFkX21vc3RseSBtZW1faG90cGx1ZzsKIAotLyogUHJpdmF0ZSBk
b21haW4gc3RydWN0cyBmb3IgRE9NSURfWEVOIGFuZCBET01JRF9JTy4gKi8KLXN0cnVjdCBkb21h
aW4gKmRvbV94ZW4sICpkb21faW8sICpkb21fY293OwotCiAvKiBGcmFtZSB0YWJsZSBzaXplIGlu
IHBhZ2VzLiAqLwogdW5zaWduZWQgbG9uZyBtYXhfcGFnZTsKIHVuc2lnbmVkIGxvbmcgdG90YWxf
cGFnZXM7CkBAIC0yODMsMzEgKzI4MCw2IEBAIHZvaWQgX19pbml0IGFyY2hfaW5pdF9tZW1vcnko
dm9pZCkKICAgICAgICAgICBfUEFHRV9ESVJUWSB8IF9QQUdFX0FWQUlMIHwgX1BBR0VfQVZBSUxf
SElHSCB8IF9QQUdFX05YKTsKIAogICAgIC8qCi0gICAgICogSW5pdGlhbGlzZSBvdXIgRE9NSURf
WEVOIGRvbWFpbi4KLSAgICAgKiBBbnkgWGVuLWhlYXAgcGFnZXMgdGhhdCB3ZSB3aWxsIGFsbG93
IHRvIGJlIG1hcHBlZCB3aWxsIGhhdmUKLSAgICAgKiB0aGVpciBkb21haW4gZmllbGQgc2V0IHRv
IGRvbV94ZW4uCi0gICAgICogSGlkZGVuIFBDSSBkZXZpY2VzIHdpbGwgYWxzbyBiZSBhc3NvY2lh
dGVkIHdpdGggdGhpcyBkb21haW4KLSAgICAgKiAoYnV0IGJlIFtwYXJ0bHldIGNvbnRyb2xsZWQg
YnkgRG9tMCBuZXZlcnRoZWxlc3MpLgotICAgICAqLwotICAgIGRvbV94ZW4gPSBkb21haW5fY3Jl
YXRlKERPTUlEX1hFTiwgTlVMTCwgZmFsc2UpOwotICAgIEJVR19PTihJU19FUlIoZG9tX3hlbikp
OwotCi0gICAgLyoKLSAgICAgKiBJbml0aWFsaXNlIG91ciBET01JRF9JTyBkb21haW4uCi0gICAg
ICogVGhpcyBkb21haW4gb3ducyBJL08gcGFnZXMgdGhhdCBhcmUgd2l0aGluIHRoZSByYW5nZSBv
ZiB0aGUgcGFnZV9pbmZvCi0gICAgICogYXJyYXkuIE1hcHBpbmdzIG9jY3VyIGF0IHRoZSBwcml2
IG9mIHRoZSBjYWxsZXIuCi0gICAgICovCi0gICAgZG9tX2lvID0gZG9tYWluX2NyZWF0ZShET01J
RF9JTywgTlVMTCwgZmFsc2UpOwotICAgIEJVR19PTihJU19FUlIoZG9tX2lvKSk7Ci0KLSAgICAv
KgotICAgICAqIEluaXRpYWxpc2Ugb3VyIENPVyBkb21haW4uCi0gICAgICogVGhpcyBkb21haW4g
b3ducyBzaGFyYWJsZSBwYWdlcy4KLSAgICAgKi8KLSAgICBkb21fY293ID0gZG9tYWluX2NyZWF0
ZShET01JRF9DT1csIE5VTEwsIGZhbHNlKTsKLSAgICBCVUdfT04oSVNfRVJSKGRvbV9jb3cpKTsK
LQotICAgIC8qCiAgICAgICogRmlyc3QgMU1CIG9mIFJBTSBpcyBoaXN0b3JpY2FsbHkgbWFya2Vk
IGFzIEkvTy4KICAgICAgKiBOb3RlIHRoYXQgYXBhcnQgZnJvbSBJTyBYZW4gYWxzbyB1c2VzIHRo
ZSBsb3cgMU1CIHRvIHN0b3JlIHRoZSBBUCBib290CiAgICAgICogdHJhbXBvbGluZSBhbmQgYm9v
dCBpbmZvcm1hdGlvbiBtZXRhZGF0YS4gRHVlIHRvIHRoaXMgYWx3YXlzIHNwZWNpYWwKLS0tIGEv
eGVuL2FyY2gveDg2L3NldHVwLmMKKysrIGIveGVuL2FyY2gveDg2L3NldHVwLmMKQEAgLTE1MzMs
NiArMTUzMyw4IEBAIHZvaWQgX19pbml0IG5vcmV0dXJuIF9fc3RhcnRfeGVuKHVuc2lnbmUKICAg
ICBtbWlvX3JvX3JhbmdlcyA9IHJhbmdlc2V0X25ldyhOVUxMLCAici9vIG1taW8gcmFuZ2VzIiwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSQU5HRVNFVEZfcHJldHR5cHJpbnRf
aGV4KTsKIAorICAgIHNldHVwX3NwZWNpYWxfZG9tYWlucygpOworCiAgICAgYWNwaV9ib290X2lu
aXQoKTsKIAogICAgIGlmICggc21wX2ZvdW5kX2NvbmZpZyApCi0tLSBhL3hlbi9jb21tb24vZG9t
YWluLmMKKysrIGIveGVuL2NvbW1vbi9kb21haW4uYwpAQCAtNzEsNiArNzEsMTEgQEAgZG9taWRf
dCBoYXJkd2FyZV9kb21pZCBfX3JlYWRfbW9zdGx5OwogaW50ZWdlcl9wYXJhbSgiaGFyZHdhcmVf
ZG9tIiwgaGFyZHdhcmVfZG9taWQpOwogI2VuZGlmCiAKKy8qIFByaXZhdGUgZG9tYWluIHN0cnVj
dHMgZm9yIERPTUlEX1hFTiwgRE9NSURfSU8sIGV0Yy4gKi8KK3N0cnVjdCBkb21haW4gKl9fcmVh
ZF9tb3N0bHkgZG9tX3hlbjsKK3N0cnVjdCBkb21haW4gKl9fcmVhZF9tb3N0bHkgZG9tX2lvOwor
c3RydWN0IGRvbWFpbiAqX19yZWFkX21vc3RseSBkb21fY293OworCiBzdHJ1Y3QgdmNwdSAqaWRs
ZV92Y3B1W05SX0NQVVNdIF9fcmVhZF9tb3N0bHk7CiAKIHZjcHVfaW5mb190IGR1bW15X3ZjcHVf
aW5mbzsKQEAgLTUyMCw2ICs1MjUsMzYgQEAgc3RydWN0IGRvbWFpbiAqZG9tYWluX2NyZWF0ZShk
b21pZF90IGRvbQogICAgIHJldHVybiBFUlJfUFRSKGVycik7CiB9CiAKK3ZvaWQgX19pbml0IHNl
dHVwX3NwZWNpYWxfZG9tYWlucyh2b2lkKQoreworICAgIC8qCisgICAgICogSW5pdGlhbGlzZSBv
dXIgRE9NSURfWEVOIGRvbWFpbi4KKyAgICAgKiBBbnkgWGVuLWhlYXAgcGFnZXMgdGhhdCB3ZSB3
aWxsIGFsbG93IHRvIGJlIG1hcHBlZCB3aWxsIGhhdmUKKyAgICAgKiB0aGVpciBkb21haW4gZmll
bGQgc2V0IHRvIGRvbV94ZW4uCisgICAgICogSGlkZGVuIFBDSSBkZXZpY2VzIHdpbGwgYWxzbyBi
ZSBhc3NvY2lhdGVkIHdpdGggdGhpcyBkb21haW4KKyAgICAgKiAoYnV0IGJlIFtwYXJ0bHldIGNv
bnRyb2xsZWQgYnkgRG9tMCBuZXZlcnRoZWxlc3MpLgorICAgICAqLworICAgIGRvbV94ZW4gPSBk
b21haW5fY3JlYXRlKERPTUlEX1hFTiwgTlVMTCwgZmFsc2UpOworICAgIGlmICggSVNfRVJSKGRv
bV94ZW4pICkKKyAgICAgICAgcGFuaWMoIkZhaWxlZCB0byBjcmVhdGUgZFtYRU5dOiAlbGRcbiIs
IFBUUl9FUlIoZG9tX3hlbikpOworCisgICAgLyoKKyAgICAgKiBJbml0aWFsaXNlIG91ciBET01J
RF9JTyBkb21haW4uCisgICAgICogVGhpcyBkb21haW4gb3ducyBJL08gcGFnZXMgdGhhdCBhcmUg
d2l0aGluIHRoZSByYW5nZSBvZiB0aGUgcGFnZV9pbmZvCisgICAgICogYXJyYXkuIE1hcHBpbmdz
IG9jY3VyIGF0IHRoZSBwcml2IG9mIHRoZSBjYWxsZXIuCisgICAgICovCisgICAgZG9tX2lvID0g
ZG9tYWluX2NyZWF0ZShET01JRF9JTywgTlVMTCwgZmFsc2UpOworICAgIGlmICggSVNfRVJSKGRv
bV9pbykgKQorICAgICAgICBwYW5pYygiRmFpbGVkIHRvIGNyZWF0ZSBkW0lPXTogJWxkXG4iLCBQ
VFJfRVJSKGRvbV9pbykpOworCisgICAgLyoKKyAgICAgKiBJbml0aWFsaXNlIG91ciBDT1cgZG9t
YWluLgorICAgICAqIFRoaXMgZG9tYWluIG93bnMgc2hhcmFibGUgcGFnZXMuCisgICAgICovCisg
ICAgZG9tX2NvdyA9IGRvbWFpbl9jcmVhdGUoRE9NSURfQ09XLCBOVUxMLCBmYWxzZSk7CisgICAg
aWYgKCBJU19FUlIoZG9tX2NvdykgKQorICAgICAgICBwYW5pYygiRmFpbGVkIHRvIGNyZWF0ZSBk
W0NPV106ICVsZFxuIiwgUFRSX0VSUihkb21fY293KSk7Cit9CiAKIHZvaWQgZG9tYWluX3VwZGF0
ZV9ub2RlX2FmZmluaXR5KHN0cnVjdCBkb21haW4gKmQpCiB7Ci0tLSBhL3hlbi9pbmNsdWRlL2Fz
bS1hcm0vbW0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20tYXJtL21tLmgKQEAgLTMzNCw4ICszMzQs
NiBAQCBsb25nIGFyY2hfbWVtb3J5X29wKGludCBvcCwgWEVOX0dVRVNUX0hBCiAKIHVuc2lnbmVk
IGxvbmcgZG9tYWluX2dldF9tYXhpbXVtX2dwZm4oc3RydWN0IGRvbWFpbiAqZCk7CiAKLWV4dGVy
biBzdHJ1Y3QgZG9tYWluICpkb21feGVuLCAqZG9tX2lvLCAqZG9tX2NvdzsKLQogI2RlZmluZSBt
ZW1ndWFyZF9ndWFyZF9zdGFjayhfcCkgICAgICAgKCh2b2lkKTApCiAjZGVmaW5lIG1lbWd1YXJk
X2d1YXJkX3JhbmdlKF9wLF9sKSAgICAoKHZvaWQpMCkKICNkZWZpbmUgbWVtZ3VhcmRfdW5ndWFy
ZF9yYW5nZShfcCxfbCkgICgodm9pZCkwKQotLS0gYS94ZW4vaW5jbHVkZS9hc20tYXJtL3NldHVw
LmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLWFybS9zZXR1cC5oCkBAIC03Nyw4ICs3Nyw2IEBAIGV4
dGVybiBzdHJ1Y3QgYm9vdGluZm8gYm9vdGluZm87CiAKIGV4dGVybiBkb21pZF90IG1heF9pbml0
X2RvbWlkOwogCi12b2lkIGFyY2hfaW5pdF9tZW1vcnkodm9pZCk7Ci0KIHZvaWQgY29weV9mcm9t
X3BhZGRyKHZvaWQgKmRzdCwgcGFkZHJfdCBwYWRkciwgdW5zaWduZWQgbG9uZyBsZW4pOwogCiBz
aXplX3QgZXN0aW1hdGVfZWZpX3NpemUoaW50IG1lbV9ucl9iYW5rcyk7Ci0tLSBhL3hlbi9pbmNs
dWRlL2FzbS14ODYvbW0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKQEAgLTU5NSw4
ICs1OTUsNiBAQCB1bnNpZ25lZCBpbnQgZG9tYWluX2NsYW1wX2FsbG9jX2JpdHNpemUoCiAKIHVu
c2lnbmVkIGxvbmcgZG9tYWluX2dldF9tYXhpbXVtX2dwZm4oc3RydWN0IGRvbWFpbiAqZCk7CiAK
LWV4dGVybiBzdHJ1Y3QgZG9tYWluICpkb21feGVuLCAqZG9tX2lvLCAqZG9tX2NvdzsJLyogZm9y
IHZtY29yZWluZm8gKi8KLQogLyogRGVmaW5pdGlvbiBvZiBhbiBtbSBsb2NrOiBzcGlubG9jayB3
aXRoIGV4dHJhIGZpZWxkcyBmb3IgZGVidWdnaW5nICovCiB0eXBlZGVmIHN0cnVjdCBtbV9sb2Nr
IHsKICAgICBzcGlubG9ja190ICAgICAgICAgbG9jazsKLS0tIGEveGVuL2luY2x1ZGUveGVuL2Rv
bWFpbi5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9kb21haW4uaApAQCAtMjIsNiArMjIsOCBAQCBz
dHJ1Y3QgdmNwdSAqYWxsb2NfZG9tMF92Y3B1MChzdHJ1Y3QgZG9tCiBpbnQgdmNwdV9yZXNldChz
dHJ1Y3QgdmNwdSAqKTsKIGludCB2Y3B1X3VwKHN0cnVjdCB2Y3B1ICp2KTsKIAordm9pZCBzZXR1
cF9zcGVjaWFsX2RvbWFpbnModm9pZCk7CisKIHN0cnVjdCB4ZW5fZG9tY3RsX2dldGRvbWFpbmlu
Zm87CiB2b2lkIGdldGRvbWFpbmluZm8oc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHhlbl9kb21j
dGxfZ2V0ZG9tYWluaW5mbyAqaW5mbyk7CiB2b2lkIGFyY2hfZ2V0X2RvbWFpbl9pbmZvKGNvbnN0
IHN0cnVjdCBkb21haW4gKmQsCi0tLSBhL3hlbi9pbmNsdWRlL3hlbi9tbS5oCisrKyBiL3hlbi9p
bmNsdWRlL3hlbi9tbS5oCkBAIC02NDIsNiArNjQyLDkgQEAgc3RhdGljIGlubGluZSB2b2lkIGZp
bHRlcmVkX2ZsdXNoX3RsYl9tYQogICAgIH0KIH0KIAorLyogUHJpdmF0ZSBkb21haW4gc3RydWN0
cyBmb3IgRE9NSURfWEVOLCBET01JRF9JTywgZXRjLiAqLworZXh0ZXJuIHN0cnVjdCBkb21haW4g
KmRvbV94ZW4sICpkb21faW8sICpkb21fY293OworCiBlbnVtIFhFTlNIQVJFX2ZsYWdzIHsKICAg
ICBTSEFSRV9ydywKICAgICBTSEFSRV9ybywKCgoKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxp
c3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9s
aXN0aW5mby94ZW4tZGV2ZWw=
